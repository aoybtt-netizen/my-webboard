<!DOCTYPE html>
<html lang="th">
<head>
	
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="/socket.io/socket.io.js"></script>
    <title>GedGo! - Admin Zone Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/all.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        :root { --primary: #11998e; --secondary: #38ef7d; --dark: #2c3e50; --light: #f8fafc; --danger: #e74c3c; }
body { font-family: 'Kanit', sans-serif; background: var(--light); margin: 0; display: flex; height: 100dvh; overflow: hidden; }

* {
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent; /* ‡∏•‡∏ö‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏ï‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
}

/* ‡πÅ‡∏ú‡πà‡∏ô‡πÉ‡∏™‡∏™‡∏µ‡∏î‡∏≥‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á */
.sidebar-overlay {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô */
    backdrop-filter: blur(2px);
}

/* ‡∏ï‡∏±‡∏ß Sidebar ‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏ó‡∏≤‡∏á‡∏ã‡πâ‡∏≤‡∏¢ -260px */
.sidebar { 
    width: 260px; 
    background: var(--dark); 
    color: white; 
    height: 100vh; 
    position: fixed; 
    left: -260px; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ */
    top: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1001;
    display: flex;
    flex-direction: column;
}

/* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Ñ‡∏•‡∏≤‡∏™ active ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ */
.sidebar.active {
    left: 0;
}

.sidebar-header { padding: 30px 20px; border-bottom: 1px solid rgba(255,255,255,0.1); text-align: center; }
.sidebar-menu { flex: 1; padding: 10px 0; }
.menu-item { 
    padding: 15px 25px; display: flex; align-items: center; gap: 12px; 
    color: rgba(255,255,255,0.7); text-decoration: none; cursor: pointer; transition: 0.2s;
}
.menu-item:hover, .menu-item.active { background: rgba(255,255,255,0.1); color: var(--secondary); border-left: 4px solid var(--secondary); }
.menu-item i { width: 20px; }
.badge { background: var(--danger); color: white; font-size: 0.7em; padding: 2px 8px; border-radius: 10px; margin-left: auto; }

/* Main Content Area */
.main-content { 
    flex: 1; 
    display: flex; 
    flex-direction: column; 
    height: 100dvh; /* ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠‡πÅ‡∏ö‡∏ö Dynamic */
    overflow: hidden; /* ‚ùå ‡∏´‡πâ‡∏≤‡∏° Scroll ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡πÅ‡∏°‡πà (‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏ß‡∏≤) */
    width: 100%; 
    background: var(--light);
}
.top-bar { 
    background: white; 
    /* ‡∏à‡∏±‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏Ç‡∏≠‡∏ö: ‡∏ö‡∏ô(‡∏´‡∏•‡∏ö Notch) ‡∏Ç‡∏ß‡∏≤ ‡∏•‡πà‡∏≤‡∏á ‡∏ã‡πâ‡∏≤‡∏¢ */
    padding: calc(15px + env(safe-area-inset-top)) 20px 15px 20px; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    width: 100%; 
    flex-shrink: 0; /* ‡∏´‡πâ‡∏≤‡∏°‡∏´‡∏î‡∏ï‡∏±‡∏ß */
    z-index: 10;
}
.content-body { 
    flex: 1; /* ‡∏Å‡∏¥‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠ */
    overflow-y: auto; /* ‚úÖ Scrollbar ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏Ñ‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ */
    padding: 15px; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏•‡∏î‡∏à‡∏≤‡∏Å 25px ‡πÄ‡∏´‡∏•‡∏∑‡∏≠ 15px ‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
    padding-bottom: calc(20px + env(safe-area-inset-bottom)); /* ‡πÄ‡∏ß‡πâ‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏´‡∏•‡∏ö‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏Æ‡∏° */
    -webkit-overflow-scrolling: touch; /* ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏•‡∏∑‡πà‡∏ô‡πÜ ‡∏ö‡∏ô iPhone */
}

/* Card Style */
.admin-card { 
    background: white; 
    border-radius: 15px; 
    padding: 20px; 
    margin-bottom: 15px; 
    box-shadow: 0 2px 8px rgba(0,0,0,0.03); 
    border: 1px solid #f1f5f9;
    display: flex; 
    justify-content: space-between; 
    align-items: center;
    width: 100%; /* ‡∏¢‡∏∑‡∏î‡πÄ‡∏ï‡πá‡∏° */
}
.status-btn { padding: 8px 15px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; margin-left: 5px; }
.btn-approve { background: #e8f5e9; color: #2e7d32; }
.btn-reject { background: #ffebee; color: #c62828; }





    </style>
</head>
<body>

    <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

<nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <h3 style="margin:0; color:var(--secondary);">GedGo! Zone</h3>
		
		
		<div style="margin-bottom: 10px;">
            <small style="color: rgba(255,255,255,0.5); font-size: 0.75em; display: block;" data-i18n-key="lbl_master_balance">
    ‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Master)
</small>
            <div style="font-size: 1.1em; font-weight: bold; color: #fff;">
                <i class="fas fa-coins" style="color: #f1c40f; margin-right: 5px;"></i>
                <span id="sidebar-usdt-balance">0.00</span> <small>USDT</small>
            </div>
        </div>
		
		<div style="display: flex; justify-content: space-between; align-items: center; padding-top: 8px; border-top: 1px solid rgba(255,255,255,0.1); margin-bottom: 10px;">
    <small style="color: rgba(255,255,255,0.5); font-size: 0.7em;">LOCAL (<span id="sidebar-zone-currency-label">---</span>)</small>
    
    <div style="font-weight: bold; color: var(--secondary); font-size: 0.95em;">
        <i class="fas fa-wallet" style="font-size: 0.8em;"></i>
        <span id="sidebar-zone-balance">0.00</span> 
        <span id="sidebar-zone-currency" style="margin-left: 2px;">USD</span>
    </div>
</div>
		
    </div>
	
	
	
	<div style="margin-top: 15px; background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); text-align: left;">
    <button onclick="openExchangeModal()" 
            style="width: 100%; background: var(--secondary); color: var(--dark); border: none; padding: 8px; border-radius: 8px; cursor: pointer; font-weight: bold; font-family: 'Kanit';"
            data-i18n-key="btn_exchange_zone">
        üí± ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏ã‡∏ô
    </button>
</div>

<div class="sidebar-menu">
    <div class="menu-item active" onclick="showContent('topup')">
        <i class="fas fa-exchange-alt"></i> 
        <span data-i18n-key="menu_transactions">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°</span>
        <span class="badge" id="topup-count">0</span>
    </div>
    
    <div class="menu-item" onclick="showContent('kyc')">
        <i class="fas fa-id-card"></i> 
        <span data-i18n-key="menu_kyc">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</span>
        <span class="badge" id="kyc-count">0</span>
    </div>
    
    <div class="menu-item" onclick="showContent('members')">
        <i class="fas fa-users"></i> 
        <span data-i18n-key="menu_members">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
    </div>
    
    <div class="menu-item" onclick="showContent('automessage')">
        <i class="fas fa-comment-dots"></i> 
        <span data-i18n-key="menu_automessage">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ)</span>
    </div>
    
    <div class="menu-item" onclick="showContent('history')">
        <i class="fas fa-history"></i> 
        <span data-i18n-key="menu_history">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô</span>
    </div>
</div>
</nav>


    <main class="main-content">
    <header class="top-bar">
        <div style="display: flex; align-items: center; gap: 15px;">
    <i class="fas fa-bars" onclick="toggleSidebar()" style="cursor:pointer; font-size: 1.2em; color: var(--dark); padding: 5px;"></i>
    <h2 id="content-title" style="margin:0; font-size: 1.1em; font-weight: 600;" data-i18n-key="title_topup">‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</h2>
</div>

        <div style="display: flex; align-items: center; gap: 15px;">
            <div id="admin-info" style="text-align: right; display: none;"> 
    <small style="display:block; color:#999; font-size:0.7em;" data-i18n-key="lbl_zone_owner">‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏ã‡∏ô</small>
    <b id="admin-name" style="font-size: 0.9em;">...</b>
</div>
            
            <a href="index.html" style="
                text-decoration: none; 
                background: #f1f5f9; 
                color: var(--dark); 
                width: 38px; 
                height: 38px; 
                border-radius: 10px; 
                display: flex; 
                align-items: center; 
                justify-content: center;
                border: 1px solid #e2e8f0;
            ">
                <i class="fas fa-home"></i>
            </a>
        </div>
    </header>

    <div class="content-body" id="main-display">
        <div style="text-align:center; margin-top: 50px; color: #999;">
    <i class="fas fa-spinner fa-spin fa-2x"></i>
    <p data-i18n-key="loading_data">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
</div>
    </div>
</main>

    <script>
	const socket = io();
	let currentZoneId = null;
	let zoneCurrency = 'USD';
	let zoneRate = 1.0;

	let currentChatRequestId = null;
	let currentKYCRequestId = null;
	
	
    function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    const overlay = document.getElementById('sidebar-overlay');
    if (!sidebar || !overlay) return;

    sidebar.classList.toggle('active');
    
    if (sidebar.classList.contains('active')) {
        overlay.style.display = 'block';
    } else {
        overlay.style.display = 'none';
    }
}




const currentLang = localStorage.getItem('preferredLanguage') || 'th';
				
const translations = {
    'th': {
        'lbl_master_balance': '‡∏ó‡∏∏‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ (Master)',
		'btn_exchange_zone': 'üí± ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÇ‡∏ã‡∏ô',
        'menu_transactions': '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°',
        'menu_kyc': '‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô',
        'menu_members': '‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
        'menu_automessage': '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ)',
        'menu_history': '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô',
		'title_topup': '‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'title_kyc': '‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô',
        'title_members': '‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
        'title_automessage': '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥',
        'title_history': '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°',
        'lbl_zone_owner': '‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÇ‡∏ã‡∏ô',
        'loading_data': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
		'title_transactionsss': '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏° (‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô/‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô)',
        'title_kyc_verificationnn': '‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô (20 ‡πÄ‡∏°‡∏ï‡∏£)',
        'title_auto_msg_settings': '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥',
        'title_zone_history': '‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ò‡∏∏‡∏£‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô',
        'title_zone_members': '‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÉ‡∏ô‡πÇ‡∏ã‡∏ô',
        'label_withdraw': '‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î',
        'label_topup': '‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'status_approved': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß',
        'status_rejected': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß',
		'chat_system_info': '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö',
        'chat_topup_amount': (amt) => `‡∏¢‡∏≠‡∏î‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏¥‡∏°: ${amt} USD`,
        'chat_history_title': (user) => `‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥: ${user}`,
        'chat_status_label': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:',
        'chat_approved': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß',
        'chat_rejected': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡πâ‡∏ß',
        'chat_time_request': '‡πÄ‡∏ß‡∏•‡∏≤‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏Ç‡∏≠:',
        'chat_time_processed': '‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:',
        'chat_locked_msg': '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß',
		'kyc_waiting': '‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô',
        'btn_check_doc': '‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£',
        'confirm_topup_msg': (amt, user) => `‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏á‡∏¥‡∏ô ${amt} USD ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì ${user}?`,
        'msg_approve_success': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à',
		'form_payment_title': '‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô',
        'lbl_bank_info': '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ / ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏û‡∏¢‡πå:',
        'lbl_topup_instructions': '‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô:',
        'btn_save_db': '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•',
        'def_topup_desc': '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏ ‡πÅ‡∏•‡∏∞‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÉ‡∏ô‡πÅ‡∏ä‡∏ó',
		'msg_save_success': '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!',
        'msg_save_error': '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å',
		'no_new_items': '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà',
        'load_failed': '‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß',
        'time_suffix': ' ‡∏ô.',
		'confirm_approve_action': (amt, user) => `‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô ${amt} USD ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì ${user}?`,
        'confirm_reject_action': (user) => `‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ${user}?`,
		'title_check_withdraw': '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô',
        'title_check_topup': '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'lbl_from_member': '‡∏à‡∏≤‡∏Å‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å:',
        'lbl_amount_type': (type) => `‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (${type})`,
        'lbl_customer_bank': '‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤:',
        'lbl_withdraw_warning': '* ‡πÇ‡∏õ‡∏£‡∏î‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏≤‡∏°‡∏¢‡∏≠‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Å‡∏î‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥',
        'btn_reject': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò',
        'btn_confirm_transfer': '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÇ‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß',
        'btn_approve_topup': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'lbl_chat_verify': '‡πÅ‡∏ä‡∏ó‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô',
        'plh_chat_input': '‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°...',
		'action_approve_withdraw': '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏´‡πâ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
        'action_approve_topup': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤',
        'action_reject_withdraw': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡∏∞‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤',
        'action_reject_topup': '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'confirm_withdraw_final': (user, amt, curr) => `‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÉ‡∏´‡πâ @${user} ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${amt} ${curr} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? (‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÇ‡∏≠‡∏ô‡πÄ‡∏´‡∏£‡∏µ‡∏¢‡∏ç‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô)`,
        'confirm_topup_final': (user, curr) => `‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ @${user} (${curr}):`,
        'confirm_general_action': (label) => `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ${label} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,
        'swal_success': '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
        'swal_error': '‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
        'sys_msg_success': (type, amt, curr) => `‚úÖ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ${type} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${amt} ${curr}`,
        'sys_msg_rejected': '‚ùå ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÇ‡∏î‡∏¢‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô',
        'withdraw_type': '‡∏ñ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô',
        'topup_type': '‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'err_server_connect': '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏î‡πâ',
		'confirm_generic': (action) => `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ ${action} ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`,
        'alert_success': '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
		'lbl_current_dist': (d) => `‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${d} ‡πÄ‡∏°‡∏ï‡∏£`,
        'status_ready': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞)',
        'status_too_far': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡πÑ‡∏Å‡∏•‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏Å‡∏•‡πâ 20‡∏°.)',
		'confirm_delete_request': (user) => `‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡πÅ‡∏•‡∏∞ "‡∏•‡∏ö" ‡∏Ñ‡∏≥‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏á @${user} ‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n(‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á)`,
        'alert_delete_success': '‡∏•‡∏ö‡∏Ñ‡∏≥‡∏Ç‡∏≠‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
		'swal_check_gps': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡πá‡∏Å‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì...',
        'swal_dist_pass': '‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á',
        'swal_dist_fail': '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á',
        'swal_dist_current': (d) => `‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <b>${d} ‡πÄ‡∏°‡∏ï‡∏£</b>`,
        'swal_in_range': '‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ 20 ‡πÄ‡∏°‡∏ï‡∏£‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î',
        'swal_out_range': '‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏Å‡∏•‡πÄ‡∏Å‡∏¥‡∏ô 20 ‡πÄ‡∏°‡∏ï‡∏£',
        'swal_btn_confirm': '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥',
        'swal_btn_cancel': '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å',
        'swal_title_denied': '‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥',
        'swal_text_denied': '‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 20 ‡πÄ‡∏°‡∏ï‡∏£‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô',
        'swal_title_gps_err': '‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î',
        'swal_text_gps_err': '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î GPS ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏ä‡πá‡∏Å‡∏£‡∏∞‡∏¢‡∏∞',
        'swal_title_success': '‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
        'swal_text_success': '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß',
		'btn_back_to_requests': '‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠',
        'btn_reject_kyc': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Ñ‡∏≥‡∏Ç‡∏≠',
        'btn_approve_kyc': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô',
        'title_kyc_detail': '‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô',
        'lbl_current_photo': '‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô',
        'status_pending': '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
        'lbl_dist_from_you': (d) => `‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì: ${d} ‡πÄ‡∏°‡∏ï‡∏£`,
		'lbl_member_info_header': '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
        'lbl_full_name': '‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•',
        'lbl_id_card': '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô',
        'lbl_phone': '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå',
        'lbl_username': 'Username',
        'lbl_geo_address': '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏û‡∏¥‡∏Å‡∏±‡∏î',
		'btn_kyc_reject': '‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò',
        'btn_kyc_approve': '‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',
        'lbl_chat_appointment': '‡πÅ‡∏ä‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
        'msg_start_chat_kyc': '‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏î‡∏û‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô',
		'title_member_profile': '‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å',
        'filter_all': '‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
        'filter_kyc': '‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡πâ‡∏ß (KYC)',
        'filter_not_kyc': '‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô',
        'filter_banned': '‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏ö‡∏ô',
		'lbl_balance': '‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠',
    },
    'en': {
        'lbl_master_balance': 'Available Balance (Master)',
		'btn_exchange_zone': 'üí± Exchange to Zone Currency',
        'menu_transactions': 'Transaction List',
        'menu_kyc': 'KYC Verification',
        'menu_members': 'Member List',
        'menu_automessage': 'Auto Message (Bank Acc)',
        'menu_history': 'Zone Transaction History',
		'title_topup': 'Top-up Requests',
        'title_kyc': 'KYC Verification',
        'title_members': 'Member List',
        'title_automessage': 'Auto Message',
        'title_history': 'Transaction History',
        'lbl_zone_owner': 'Zone Owner',
        'loading_data': 'Loading data...',
		'title_transactionsss': 'Transactions (Top-up/Withdraw)',
        'title_kyc_verificationnn': 'KYC Verification (20m)',
        'title_auto_msg_settings': 'Auto Message Settings',
        'title_zone_history': 'Zone Transaction History',
        'title_zone_members': 'Zone Member List',
        'label_withdraw': 'Withdraw Cash',
        'label_topup': 'Top-up',
        'status_approved': 'Approved',
        'status_rejected': 'Rejected',
		'chat_system_info': 'Initial system data',
        'chat_topup_amount': (amt) => `Top-up Amount: ${amt} USD`,
        'chat_history_title': (user) => `History: ${user}`,
        'chat_status_label': 'Status:',
        'chat_approved': 'Approved',
        'chat_rejected': 'Rejected',
        'chat_time_request': 'Request Time:',
        'chat_time_processed': 'Processed Time:',
        'chat_locked_msg': 'This transaction has been completed.',
		'kyc_waiting': 'Waiting for document verification',
        'btn_check_doc': 'Verify Docs',
        'confirm_topup_msg': (amt, user) => `Approve ${amt} USD for ${user}?`,
        'msg_approve_success': 'Approval successful',
		'form_payment_title': 'Payment Settings',
        'lbl_bank_info': 'Bank Account / Payment Details:',
        'lbl_topup_instructions': 'Top-up Instructions:',
        'btn_save_db': 'Save to Database',
        'def_topup_desc': 'Please transfer the specified amount and attach the slip in the chat.',
		'msg_save_success': 'Saved successfully! Members will see this information immediately.',
        'msg_save_error': 'An error occurred while saving.',
		'no_new_items': 'No new items',
        'load_failed': 'Failed to load data',
        'time_suffix': '',
		'confirm_approve_action': (amt, user) => `Confirm top-up ${amt} USD for ${user}?`,
        'confirm_reject_action': (user) => `Reject request from ${user}?`,
		'title_check_withdraw': 'Verify Withdrawal',
        'title_check_topup': 'Verify Top-up',
        'lbl_from_member': 'From Member:',
        'lbl_amount_type': (type) => `Transaction Amount (${type})`,
        'lbl_customer_bank': 'Customer Bank Account:',
        'lbl_withdraw_warning': '* Please transfer cash to the customer before approving',
        'btn_reject': 'Reject',
        'btn_confirm_transfer': 'Transfer Confirmed',
        'btn_approve_topup': 'Approve Top-up',
        'lbl_chat_verify': 'Evidence Verification Chat',
        'plh_chat_input': 'Type a message...',
		'action_approve_withdraw': 'Confirm cash transfer to customer completed',
        'action_approve_topup': 'Approve wallet top-up',
        'action_reject_withdraw': 'Reject and refund to customer wallet',
        'action_reject_topup': 'Cancel top-up request',
        'confirm_withdraw_final': (user, amt, curr) => `Have you transferred cash to @${user} for ${amt} ${curr}? (Coins will be moved to admin)`,
        'confirm_topup_final': (user, curr) => `Confirm amount to top up for @${user} (${curr}):`,
        'confirm_general_action': (label) => `Are you sure you want to ${label}?`,
        'swal_success': 'Success!',
        'swal_error': 'Error',
        'sys_msg_success': (type, amt, curr) => `‚úÖ ${type} completed: ${amt} ${curr}`,
        'sys_msg_rejected': '‚ùå Request rejected by admin',
        'withdraw_type': 'Withdrawal',
        'topup_type': 'Top-up',
        'err_server_connect': 'Cannot connect to server',
		'confirm_generic': (action) => `Are you sure you want to ${action} this request?`,
        'alert_success': 'Action completed successfully!',
		'lbl_current_dist': (d) => `Current distance: ${d} meters`,
        'status_ready': 'Status: Ready to Approve (Within Range)',
        'status_too_far': 'Status: Too far (Must be within 20m)',
		'confirm_delete_request': (user) => `Are you sure you want to reject and "DELETE" the request from @${user}?\n(Member will need to resubmit the information)`,
        'alert_delete_success': 'Request deleted successfully',
		'swal_check_gps': 'Checking your coordinates...',
        'swal_dist_pass': 'Distance Condition Met',
        'swal_dist_fail': 'Distance Condition Failed',
        'swal_dist_current': (d) => `Current distance: <b>${d} meters</b>`,
        'swal_in_range': 'Within the required 20m range',
        'swal_out_range': 'You are too far from the 20m limit',
        'swal_btn_confirm': 'Confirm Approval',
        'swal_btn_cancel': 'Cancel',
        'swal_title_denied': 'Not Approved',
        'swal_text_denied': 'Distance must not exceed 20 meters',
        'swal_title_gps_err': 'GPS Error',
        'swal_text_gps_err': 'Please enable GPS before checking distance',
        'swal_title_success': 'Success!',
        'swal_text_success': 'Member identity verified successfully',
		'btn_back_to_requests': 'Back to Requests',
        'btn_reject_kyc': 'Reject Request',
        'btn_approve_kyc': 'Approve & Top-up',
        'title_kyc_detail': 'KYC Details',
        'lbl_current_photo': 'Current Photo',
        'status_pending': 'Status: Pending',
        'lbl_dist_from_you': (d) => `Distance from you: ${d} m`,
		'lbl_member_info_header': 'Member Information',
        'lbl_full_name': 'Full Name',
        'lbl_id_card': 'ID Card Number',
        'lbl_phone': 'Phone Number',
        'lbl_username': 'Username',
        'lbl_geo_address': 'GPS Address',
		'btn_kyc_reject': 'Reject',
        'btn_kyc_approve': 'Approve Verification',
        'lbl_chat_appointment': 'Appointment Chat',
        'msg_start_chat_kyc': 'Start conversation to schedule verification',
		'title_member_profile': 'Member Profiles',
        'filter_all': 'Show All Members',
        'filter_kyc': 'KYC Verified Only',
        'filter_not_kyc': 'Not Verified Yet',
        'filter_banned': 'Banned Members Only',
		'lbl_balance': 'Balance',
    },
    'pt': {
        'lbl_master_balance': 'Saldo Dispon√≠vel (Master)',
		'btn_exchange_zone': 'üí± Converter para Moeda da Zona',
        'menu_transactions': 'Lista de Transa√ß√µes',
        'menu_kyc': 'Verifica√ß√£o de Identidade',
        'menu_members': 'Lista de Membros',
        'menu_automessage': 'Mensagem Autom√°tica (Conta)',
        'menu_history': 'Hist√≥rico de Transa√ß√µes',
		'title_topup': 'Pedidos de Recarga',
        'title_kyc': 'Verifica√ß√£o de Identidade',
        'title_members': 'Lista de Membros',
        'title_automessage': 'Mensagem Autom√°tica',
        'title_history': 'Hist√≥rico de Transa√ß√µes',
        'lbl_zone_owner': 'Propriet√°rio da Zona',
        'loading_data': 'Carregando dados...',
		'title_transactionsss': 'Transa√ß√µes (Dep√≥sito/Saque)',
        'title_kyc_verificationnn': 'Verifica√ß√£o de Identidade (20m)',
        'title_auto_msg_settings': 'Configura√ß√£o de Mensagem Autom√°tica',
        'title_zone_history': 'Hist√≥rico da Zona',
        'title_zone_members': 'Membros da Zona',
        'label_withdraw': 'Saque em Dinheiro',
        'label_topup': 'Recarregar',
        'status_approved': 'Aprovado',
        'status_rejected': 'Rejeitado',
		'chat_system_info': 'Dados iniciais do sistema',
        'chat_topup_amount': (amt) => `Valor da Recarga: ${amt} USD`,
        'chat_history_title': (user) => `Hist√≥rico: ${user}`,
        'chat_status_label': 'Status:',
        'chat_approved': 'Aprovado',
        'chat_rejected': 'Rejeitado',
        'chat_time_request': 'Hora do Pedido:',
        'chat_time_processed': 'Hora do Processamento:',
        'chat_locked_msg': 'Esta transa√ß√£o foi conclu√≠da.',
		'kyc_waiting': 'Aguardando verifica√ß√£o de documentos',
        'btn_check_doc': 'Verificar Docs',
        'confirm_topup_msg': (amt, user) => `Aprovar ${amt} USD para ${user}?`,
        'msg_approve_success': 'Aprova√ß√£o bem-sucedida',
		'form_payment_title': 'Configura√ß√µes de Pagamento',
        'lbl_bank_info': 'Conta Banc√°ria / Detalhes de Pagamento:',
        'lbl_topup_instructions': 'Instru√ß√µes de Recarga:',
        'btn_save_db': 'Salvar no Banco de Dados',
        'def_topup_desc': 'Por favor, transfira o valor especificado e anexe o comprovante no chat.',
		'msg_save_success': 'Salvo com sucesso! Os membros ver√£o esta informa√ß√£o imediatamente.',
        'msg_save_error': 'Ocorreu um erro ao salvar.',
		'no_new_items': 'Sem novos itens',
        'load_failed': 'Falha ao carregar dados',
        'time_suffix': '',
		'confirm_approve_action': (amt, user) => `Confirmar recarga de ${amt} USD para ${user}?`,
        'confirm_reject_action': (user) => `Rejeitar solicita√ß√£o de ${user}?`,
		'title_check_withdraw': 'Verificar Saque',
        'title_check_topup': 'Verificar Recarga',
        'lbl_from_member': 'Do Membro:',
        'lbl_amount_type': (type) => `Valor da Transa√ß√£o (${type})`,
        'lbl_customer_bank': 'Conta Banc√°ria do Cliente:',
        'lbl_withdraw_warning': '* Por favor, transfira o dinheiro antes de aprovar',
        'btn_reject': 'Rejeitar',
        'btn_confirm_transfer': 'Transfer√™ncia Confirmada',
        'btn_approve_topup': 'Aprovar Recarga',
        'lbl_chat_verify': 'Chat de Verifica√ß√£o',
        'plh_chat_input': 'Digite uma mensagem...',
		'action_approve_withdraw': 'Confirmar transfer√™ncia de dinheiro conclu√≠da',
        'action_approve_topup': 'Aprovar recarga da carteira',
        'action_reject_withdraw': 'Rejeitar e reembolsar a carteira do cliente',
        'action_reject_topup': 'Cancelar pedido de recarga',
        'confirm_withdraw_final': (user, amt, curr) => `Voc√™ transferiu o dinheiro para @${user} no valor de ${amt} ${curr}? (As moedas ser√£o movidas para o admin)`,
        'confirm_topup_final': (user, curr) => `Confirmar valor da recarga para @${user} (${curr}):`,
        'confirm_general_action': (label) => `Tem certeza que deseja ${label}?`,
        'swal_success': 'Sucesso!',
        'swal_error': 'Erro',
        'sys_msg_success': (type, amt, curr) => `‚úÖ ${type} conclu√≠da: ${amt} ${curr}`,
        'sys_msg_rejected': '‚ùå Pedido rejeitado pelo administrador',
        'withdraw_type': 'Saque',
        'topup_type': 'Recarga',
        'err_server_connect': 'N√£o foi poss√≠vel conectar ao servidor',
		'confirm_generic': (action) => `Tem certeza que deseja ${action} este pedido?`,
        'alert_success': 'A√ß√£o realizada com sucesso!',
		'lbl_current_dist': (d) => `Dist√¢ncia atual: ${d} metros`,
        'status_ready': 'Status: Pronto para Aprovar (Dentro do Alcance)',
        'status_too_far': 'Status: Muito longe (Deve estar a 20m)',
		'confirm_delete_request': (user) => `Tem certeza que deseja rejeitar e "EXCLUIR" o pedido de @${user}?\n(O membro precisar√° enviar as informa√ß√µes novamente)`,
        'alert_delete_success': 'Pedido exclu√≠do com sucesso',
		'swal_check_gps': 'Verificando suas coordenadas...',
        'swal_dist_pass': 'Crit√©rio de dist√¢ncia aceito',
        'swal_dist_fail': 'Crit√©rio de dist√¢ncia n√£o aceito',
        'swal_dist_current': (d) => `Dist√¢ncia atual: <b>${d} metros</b>`,
        'swal_in_range': 'Dentro do alcance de 20m exigido',
        'swal_out_range': 'Voc√™ est√° al√©m do limite de 20m',
        'swal_btn_confirm': 'Confirmar Aprova√ß√£o',
        'swal_btn_cancel': 'Cancelar',
        'swal_title_denied': 'N√£o Aprovado',
        'swal_text_denied': 'A dist√¢ncia deve ser de no m√°ximo 20 metros',
        'swal_title_gps_err': 'Erro de GPS',
        'swal_text_gps_err': 'Ative o GPS antes de verificar a dist√¢ncia',
        'swal_title_success': 'Sucesso!',
        'swal_text_success': 'Identidade do membro verificada com sucesso',
		'btn_back_to_requests': 'Voltar aos Pedidos',
        'btn_reject_kyc': 'Rejeitar Pedido',
        'btn_approve_kyc': 'Aprovar e Recarregar',
        'title_kyc_detail': 'Detalhes do KYC',
        'lbl_current_photo': 'Foto Atual',
        'status_pending': 'Status: Pendente',
        'lbl_dist_from_you': (d) => `Dist√¢ncia de voc√™: ${d} m`,
		'lbl_member_info_header': 'Informa√ß√µes do Membro',
        'lbl_full_name': 'Nome Completo',
        'lbl_id_card': 'N√∫mero do Documento',
        'lbl_phone': 'Telefone',
        'lbl_username': 'Usu√°rio',
        'lbl_geo_address': 'Endere√ßo GPS',
		'btn_kyc_reject': 'Rejeitar',
        'btn_kyc_approve': 'Aprovar Verifica√ß√£o',
        'lbl_chat_appointment': 'Chat de Agendamento',
        'msg_start_chat_kyc': 'Inicie a conversa para agendar a verifica√ß√£o',
		'title_member_profile': 'Perfis de Membros',
        'filter_all': 'Mostrar Todos os Membros',
        'filter_kyc': 'Apenas KYC Verificado',
        'filter_not_kyc': 'Ainda N√£o Verificado',
        'filter_banned': 'Apenas Membros Banidos',
		'lbl_balance': 'Saldo',
    }
};

function applyMerchantTranslations() {
    console.log(`[i18n] Applying translations for: ${currentLang}`);

    // ‡πÉ‡∏ä‡πâ data-i18n-key ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏û‡∏≠‡∏Ñ‡∏£‡∏±‡∏ö
    document.querySelectorAll('[data-i18n-key]').forEach(el => {
        const key = el.getAttribute('data-i18n-key');
        const translatedText = translations[currentLang]?.[key];

        if (translatedText) {
            // üö© ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Input / Textarea) ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ó‡∏µ‡πà Placeholder
            if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                el.placeholder = translatedText;
            } 
            // üö© ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 2: ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô Element ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô <i> ‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô
            else {
                const icon = el.querySelector('i');
                if (icon) {
                    el.innerHTML = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤
                    el.appendChild(icon); // ‡πÉ‡∏™‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°
                    el.insertAdjacentHTML('beforeend', ' ' + translatedText); // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                } else {
                    // üö© ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 3: ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô
                    el.innerText = translatedText;
                }
            }
        }
    });
}

// ‡∏™‡∏±‡πà‡∏á‡∏£‡∏±‡∏ô‡∏ï‡∏≠‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
window.addEventListener('DOMContentLoaded', () => {
    applyMerchantTranslations();
});



    async function showContent(type) {
    const display = document.getElementById('main-display');
    const title = document.getElementById('content-title');
	const membersListSec = document.getElementById('section-members-list');
    
    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏≤‡∏¢ (‡∏£‡∏ß‡∏° KYC ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏•‡∏±‡∏ö) ---
    const topupListSec = document.getElementById('section-topup-list');
    const adminChatSec = document.getElementById('section-admin-chat');
    const kycListSec = document.getElementById('section-kyc-list'); // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏™‡πà‡∏ß‡∏ô KYC
	const membersListSec = document.getElementById('section-members-list');

    // 2. ‡∏™‡∏£‡πâ‡∏≤‡∏á/‡∏î‡∏∂‡∏á "‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏•‡∏±‡∏ö"
    let storage = document.getElementById('hidden-storage');
    if (!storage) {
        storage = document.createElement('div');
        storage.id = 'hidden-storage';
        storage.style.display = 'none';
        document.body.appendChild(storage);
    }

    // 3. ‡∏¢‡πâ‡∏≤‡∏¢‡∏ó‡∏∏‡∏Å Section ‡πÑ‡∏õ‡∏û‡∏±‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏ô storage ‡∏Å‡πà‡∏≠‡∏ô (‡∏Ç‡∏≠‡∏á‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô‡∏•‡∏ö‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥)
    if (topupListSec) storage.appendChild(topupListSec);
    if (adminChatSec) storage.appendChild(adminChatSec);
    if (kycListSec) storage.appendChild(kycListSec);
	if (membersListSec) storage.appendChild(membersListSec);

    // 4. ‡∏•‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å (‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡πÄ‡∏û‡∏£‡∏≤‡∏∞ Element ‡∏à‡∏£‡∏¥‡∏á‡∏ñ‡∏π‡∏Å‡∏¢‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏ó‡∏µ‡πà storage ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ó‡∏≥‡∏•‡∏≤‡∏¢)
    display.innerHTML = ''; 

    // ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏°‡∏ô‡∏π (Active)
    document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
    let targetItem = document.querySelector(`.menu-item[onclick*="'${type}'"]`);
    if (targetItem) targetItem.classList.add('active');

    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó (Switch View) ---

    if (type === 'topup') {
        title.innerText = translations[currentLang].title_transactionsss;
        if (topupListSec) display.appendChild(topupListSec);
        display.appendChild(topupListSec);
        display.appendChild(adminChatSec);

        adminChatSec.style.display = 'none';
        topupListSec.style.display = 'block';
        
        document.getElementById('topup-list-container').innerHTML = '<p style="text-align:center; color:#999; margin-top:20px;">Loadding...</p>';
        loadTopupRequests(); 

    } else if (type === 'kyc') { // ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏° Logic ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ KYC
        title.innerText = translations[currentLang].title_kyc_verificationnn;
        if (kycListSec) display.appendChild(kycListSec);
        display.appendChild(kycListSec);
        
        kycListSec.style.display = 'block';
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î
        document.getElementById('kyc-list-container').innerHTML = '<p style="text-align:center; color:#999; margin-top:20px;"><i class="fas fa-spinner fa-spin"></i> Checking coordinates and loading data...</p>';
        loadKYCRequests(); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°)

    } else if (type === 'automessage') {
        title.innerText = translations[currentLang].title_auto_msg_settings;
        display.innerHTML = '<p style="text-align:center; color:#999; padding:20px;">loading data...</p>';
        try {
            const adminName = localStorage.getItem('myUsername');
            const res = await fetch(`/api/admin/get-settings?admin=${adminName}`);
            const settings = await res.json();
            display.innerHTML = renderAutoMessageForm(settings.bankInfo, settings.desc);
        } catch (e) {
            display.innerHTML = renderAutoMessageForm();
        }

    } else if (type === 'history') {
        title.innerText = translations[currentLang].title_zone_history;
        display.innerHTML = `<div id="admin-history-container" style="padding: 10px;"><p style="text-align:center; color:#999;">loading...</p></div>`;
        loadAdminHistory(); 
    }else if (type === 'members') {
    title.innerText = translations[currentLang].title_zone_members;
    if (membersListSec) {
            display.appendChild(membersListSec);
            membersListSec.style.display = 'block';
            loadMemberList();
        } else {
            display.innerHTML = '<p style="color:red; text-align:center;">Error: Member Section not found!</p>';
        }
}
    
    if(window.innerWidth <= 768 && document.getElementById('sidebar')?.classList.contains('active')) {
        toggleSidebar();
    }
}


async function loadAdminHistory() {
    const adminName = localStorage.getItem('myUsername');
    const container = document.getElementById('admin-history-container');
    if (!container) return;

    try {
        const res = await fetch(`/api/admin/topup-history?admin=${adminName}`);
        const history = await res.json();

        if (history.length === 0) {
            container.innerHTML = '<div style="text-align:center; margin-top:50px; color:#999;"><i class="fas fa-history fa-3x"></i><p>No history data.</p></div>';
            return;
        }

        container.innerHTML = history.map(item => {
            const isWithdraw = item.type === 'WITHDRAW';
            const color = isWithdraw ? 'var(--danger)' : 'var(--primary)';
            const label = isWithdraw ? translations[currentLang].label_withdraw : translations[currentLang].label_topup;
            const icon = isWithdraw ? 'fas fa-arrow-up' : 'fas fa-arrow-down';
            const statusLabel = item.status === 'approved' 
				? translations[currentLang].status_approved 
				: translations[currentLang].status_rejected;
            
            // ‚úÖ ‡∏î‡∏∂‡∏á‡∏™‡∏Å‡∏∏‡∏•‡πÄ‡∏á‡∏¥‡∏ô‡∏à‡∏≤‡∏Å item (Raw value ‡πÄ‡∏ä‡πà‡∏ô BRL) ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ USD
            const currency = item.currency || 'USD';

            return `
            <div class="admin-card" onclick="viewArchivedAdminChat('${item._id}', '${item.username}', ${item.amount}, '${item.status}', '${item.slipUrl || ""}', '${item.createdAt}', '${item.processedAt}', '${currency}')" 
                 style="cursor:pointer; display:flex; justify-content:space-between; align-items:center; border-left: 5px solid ${item.status === 'approved' ? 'var(--primary)' : 'var(--danger)'}; margin-bottom: 10px; background: #fff; padding: 15px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                <div style="flex: 1;">
                    <div style="font-size: 0.8em; color: ${color}; font-weight: bold; margin-bottom: 2px;">
                        <i class="${icon}"></i> ${label}
                    </div>
                    <strong>User: ${item.username}</strong><br>
                    <span style="color:${item.status === 'approved' ? 'var(--primary)' : 'var(--danger)'}; font-weight:bold;">
                        ${statusLabel}: ${item.amount.toLocaleString(undefined, {minimumFractionDigits:2})} ${currency}
                    </span>
                </div>
                <div style="text-align:right;">
                    <small style="color:#999; display:block;">${new Date(item.processedAt).toLocaleString('th-TH')}</small>
                    <i class="fas fa-chevron-right" style="color:#eee; margin-top:5px;"></i>
                </div>
            </div>
            `;
        }).join('');
    } catch (err) {
        console.error("Load Admin History Error:", err);
        container.innerHTML = '<p style="text-align:center; color:red;">Data loading failed.</p>';
    }
}


async function viewArchivedAdminChat(requestId, username, amount, status, slipUrl, createdAt, processedAt) {
    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Section ‡∏´‡∏•‡∏±‡∏Å‡∏´‡∏≤‡∏¢ (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°) ---
    const topupListSec = document.getElementById('section-topup-list');
    const adminChatSec = document.getElementById('section-admin-chat');
    let storage = document.getElementById('hidden-storage') || document.createElement('div');
    if (!storage.id) { storage.id = 'hidden-storage'; storage.style.display = 'none'; document.body.appendChild(storage); }
    if (topupListSec) storage.appendChild(topupListSec);
    if (adminChatSec) storage.appendChild(adminChatSec);

    currentChatRequestId = requestId;
    const display = document.getElementById('main-display');
    
    let slipSection = "";
    if (slipUrl && slipUrl !== "") {
        slipSection = `<div style="align-self: flex-start; background: white; padding: 10px; border-radius: 10px; border: 1px solid #ddd; max-width: 70%; margin-bottom:10px;">
            <div style="font-size: 0.8em; color: #666; margin-bottom: 5px;"><i class="fas fa-info-circle"></i> ${translations[currentLang].chat_system_info}</div>
            <img src="${slipUrl}" style="max-width: 100%; border-radius: 5px; cursor: pointer;" onclick="window.open('${slipUrl}')">
            <div style="margin-top: 5px; font-weight: bold; color: var(--dark);">${translations[currentLang].chat_topup_amount(amount.toFixed(2))}</div>
        </div>`;
    }

    display.innerHTML = `
        <div id="full-chat-container" style="display: flex; flex-direction: column; height: calc(100vh - 100px); background: white; margin: -25px; position: relative;">
            <div style="padding: 15px 20px; background: white; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 15px;">
                <button onclick="showContent('history')" style="border:none; background:#f8fafc; width:40px; height:40px; border-radius:50%; cursor:pointer;"><i class="fas fa-arrow-left"></i></button>
                <div>
                    <h4 style="margin:0;">${translations[currentLang].chat_history_title(username)}</h4>
                    <small style="color:${status === 'approved' ? 'var(--primary)' : 'var(--danger)'}; font-weight:bold;">
                        ${translations[currentLang].chat_status_label} ${status === 'approved' ? translations[currentLang].chat_approved : translations[currentLang].chat_rejected} (${amount.toFixed(2)} USD)
                    </small>
                </div>
            </div>

            <div id="chat-box" style="flex: 1; padding: 20px; background: #f1f5f9; overflow-y: auto; display: flex; flex-direction: column; gap: 10px;">
                ${slipSection} 
            </div>

            <div style="padding: 15px; background: #fff; border-top: 1px solid #eee; color: #666; font-size: 0.85em; line-height: 1.6;">
                <div style="display: flex; justify-content: space-between;">
                    <span><i class="far fa-clock"></i> ${translations[currentLang].chat_time_request}</span>
                    <b>${createdAt ? new Date(createdAt).toLocaleString(dateLocale) : '-'}</b>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span><i class="fas fa-check-double"></i> ${translations[currentLang].chat_time_processed}</span>
                    <b>${processedAt ? new Date(processedAt).toLocaleString(dateLocale) : '-'}</b>
                </div>
                <div style="text-align: center; color: #ccc; margin-top: 8px; font-size: 0.9em;">
                    <i class="fas fa-lock"></i> ${translations[currentLang].chat_locked_msg}
                </div>
            </div>
        </div>`;

    await loadAdminChatHistory(requestId);
}



        // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£ Render ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ KYC
    function renderKYCList() {
    return `
        <div class="admin-card">
            <div>
                <strong>User: Maria_Brazil</strong><br>
                <small style="color:#666;">${translations[currentLang].kyc_waiting}</small>
            </div>
            <div>
                <button class="status-btn btn-approve">${translations[currentLang].btn_check_doc}</button>
            </div>
        </div>
    `;
}

function confirmTopup(user, amount) {
    if(confirm(translations[currentLang].confirm_topup_msg(amount, user))) {
        alert(translations[currentLang].msg_approve_success);
    }
}

    window.onload = async () => {
    const myUsername = localStorage.getItem('myUsername');
    if (!myUsername) { 
        window.location.href = 'index.html'; 
        return; 
    }

    document.getElementById('admin-name').innerText = myUsername;

    // --- ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà: ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ã‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡∏î‡∏π‡πÅ‡∏• ---
    await fetchAdminZoneInfo(myUsername);

    updateBadges();
    loadTopupRequests();
    showContent('topup'); 
};



function renderAutoMessageForm(bankInfo = "", desc = "") {
    const displayBank = bankInfo || "";
    const displayDesc = desc || translations[currentLang].def_topup_desc;

    return `
        <div class="admin-card" style="display: block; max-width: 600px; margin: 0 auto;">
            <h3 style="margin-top:0; color:var(--primary); border-bottom:1px solid #eee; padding-bottom:10px;">
                ${translations[currentLang].form_payment_title}
            </h3>
            <div style="margin-bottom: 20px;">
                <label style="font-weight: bold; display: block; margin-bottom: 8px;">
                    ${translations[currentLang].lbl_bank_info}
                </label>
                <textarea id="bank-info-input" rows="3" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-family: inherit;">${displayBank}</textarea>
            </div>
            <div style="margin-bottom: 20px;">
                <label style="font-weight: bold; display: block; margin-bottom: 8px;">
                    ${translations[currentLang].lbl_topup_instructions}
                </label>
                <textarea id="topup-desc-input" rows="4" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-family: inherit;">${displayDesc}</textarea>
            </div>
            <button onclick="saveAutoMessage()" style="width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: 0.3s;">
                <i class="fas fa-save"></i> ${translations[currentLang].btn_save_db}
            </button>
        </div>
    `;
}

async function saveAutoMessage() {
    const bankInfo = document.getElementById('bank-info-input').value;
    const desc = document.getElementById('topup-desc-input').value;
    const adminName = localStorage.getItem('myUsername'); // ‡∏î‡∏∂‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô

    try {
        const res = await fetch('/api/admin/save-settings', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ adminName, bankInfo, desc })
        });

        if (res.ok) {
            // ‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÄ‡∏ã‡∏ü‡∏•‡∏á localStorage ‡πÑ‡∏ß‡πâ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Admin ‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô
            localStorage.setItem('adminBankInfo', bankInfo);
            localStorage.setItem('adminTopupDesc', desc);
            alert(translations[currentLang].msg_save_success);
        } else {
            alert(translations[currentLang].msg_save_error);
        }
    } catch (e) {
        console.error(e);
        alert("Unable to connect to the server.");
    }
}





	async function updateBadges() {
    const myUsername = localStorage.getItem('myUsername');
    try {
        const res = await fetch(`/api/admin/pending-counts?admin=${myUsername}`);
        if (!res.ok) throw new Error('API Not Ready');
        const data = await res.json();
        document.getElementById('topup-count').innerText = data.topupCount || 0;
        document.getElementById('kyc-count').innerText = data.kycCount || 0;
    } catch(e) {
        console.warn("Badge API Not yet available.");
    }
}





async function loadTopupRequests() {
    const currentLang = localStorage.getItem('preferredLanguage') || 'th'; // ‡∏î‡∏∂‡∏á‡∏†‡∏≤‡∏©‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
    const timeLocale = { 'th': 'th-TH', 'en': 'en-US', 'pt': 'pt-PT' }[currentLang]; // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Format ‡πÄ‡∏ß‡∏•‡∏≤
    
    const adminName = localStorage.getItem('myUsername');
    const container = document.getElementById('topup-list-container');
    if (!container) return;

    try {
        const res = await fetch(`/api/admin/topup-list?admin=${adminName}`);
        const requests = await res.json();
        
        if (requests.length === 0) {
            container.innerHTML = `<div style="text-align:center; margin-top:50px; color:#999;">
                <i class="fas fa-inbox fa-3x"></i>
                <p>${translations[currentLang].no_new_items}</p>
            </div>`;
            return;
        }

        container.innerHTML = requests.map(req => {
            const reqType = (req.type || 'TOPUP').toUpperCase(); 
            const isWithdraw = reqType === 'WITHDRAW';
            const currency = req.currency || 'USD';
            const color = isWithdraw ? 'var(--danger)' : 'var(--primary)';
            
            // üö© ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏õ‡∏•‡∏†‡∏≤‡∏©‡∏≤
            const label = isWithdraw ? translations[currentLang].label_withdraw : translations[currentLang].label_topup;
            const icon = isWithdraw ? 'fas fa-arrow-circle-up' : 'fas fa-arrow-circle-down';

            return `
            <div class="admin-card" onclick="openFullChat('${req._id}', '${req.username}', ${req.amount}, '${reqType}', '${encodeURIComponent(req.bankInfo || "")}', '${currency}')" 
             style="cursor:pointer; display:flex; justify-content:space-between; align-items:center; border-left: 5px solid ${color};">
                <div>
                    <div style="font-size: 0.85em; color: ${color}; font-weight: bold; margin-bottom: 5px;">
                        <i class="${icon}"></i> ${label}
                    </div>
                    <strong style="font-size: 1.1em; color: var(--dark);">@${req.username}</strong><br>
                    <span style="color:${color}; font-weight:bold; font-size: 1.2em;">${req.amount.toFixed(2)} ${currency}</span>
                </div>
                <div style="text-align:right; color:#999;">
                    <small>${new Date(req.createdAt).toLocaleTimeString(timeLocale)}${translations[currentLang].time_suffix}</small><br>
                    <i class="fas fa-chevron-right" style="margin-top: 10px; opacity: 0.3;"></i>
                </div>
            </div>
            `;
        }).join('');
    } catch (err) {
        container.innerHTML = `<p style="text-align:center; color:red;">${translations[currentLang].load_failed}</p>`;
    }
}


async function handleQuickAction(requestId, status, username, amount = 0) {
    const actionText = status === 'approved' 
    ? translations[currentLang].confirm_approve_action(amount, username) 
    : translations[currentLang].confirm_reject_action(username);
    
    if (!confirm(actionText)) return;

    try {
        const res = await fetch('/api/admin/process-topup', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                requestId: requestId, 
                status: status,
                adminName: localStorage.getItem('myUsername')
            })
        });

        if (res.ok) {
            alert("Operation successful!");
            
            // ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì Socket ‡∏ö‡∏≠‡∏Å User ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏Ç‡∏≤‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
            socket.emit('statusChanged', { 
                requestId: requestId, 
                status: status 
            });

            // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏≠‡∏Å
            loadTopupRequests();
            updateBadges();
        } else {
            alert("An error occurred while saving the data.");
        }
    } catch (e) {
        console.error(e);
        alert("There was a problem with the server connection.");
    }
}


async function loadAdminChatHistory(requestId) {
    const chatBox = document.getElementById('chat-box');
    try {
        const res = await fetch(`/api/topup/chat-history?requestId=${requestId}`);
        const history = await res.json();
        
        if (Array.isArray(history)) {
            history.forEach(msg => {
                appendAdminChatMessage(msg);
            });
        }
    } catch (err) {
        console.error("üö® Load chat history error:", err);
    }
}


// 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏ä‡∏ó
async function openFullChat(requestId, username, amount, type, bankInfoEncoded, currency) {
    currentChatRequestId = requestId;
    const isWithdraw = type === 'WITHDRAW';
    const bankInfo = decodeURIComponent(bankInfoEncoded);
    const themeColor = isWithdraw ? 'var(--danger)' : 'var(--primary)';
    
    socket.emit('joinRequest', requestId);

    // üö© ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏õ‡∏•
    const titleHeader = isWithdraw ? translations[currentLang].title_check_withdraw : translations[currentLang].title_check_topup;
    const mainIcon = isWithdraw ? 'fas fa-money-bill-transfer' : 'fas fa-hand-holding-usd';
    const cardBorderColor = isWithdraw ? '#ffcdd2' : '#c8e6c9';
    const cardBgColor = isWithdraw ? '#fff5f5' : '#e8f5e9'; 
    const textStatusColor = isWithdraw ? '#c62828' : '#2e7d32';

    let withdrawInfoHtml = "";
    if (isWithdraw) {
        withdrawInfoHtml = `
            <div style="background: #f8fafc; padding: 15px; border-radius: 15px; border: 1px dashed #e74c3c; margin-bottom: 25px;">
                <b style="color: #c62828; display: block; margin-bottom: 5px;"><i class="fas fa-university"></i> ${translations[currentLang].lbl_customer_bank}</b>
                <div style="background: white; padding: 10px; border-radius: 8px; font-family: monospace; user-select: all; border: 1px solid #eee;">
                    ${bankInfo.replace(/\n/g, '<br>')}
                </div>
                <small style="color: #666; margin-top: 5px; display: block;">${translations[currentLang].lbl_withdraw_warning}</small>
            </div>`;
    }

    const display = document.getElementById('main-display');
    display.innerHTML = `
    <div id="topup-full-modal" style="position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100dvh; background: white; overflow-y: auto; display: flex; flex-direction: column;">
        
        <div style="position: sticky; top: 0; background: white; z-index: 100; padding: calc(15px + env(safe-area-inset-top)) 20px 15px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #eee;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <button onclick="closeFullChatModal()" style="border: none; background: #f1f5f9; width: 40px; height: 40px; border-radius: 50%; cursor: pointer;">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div>
                    <h3 style="margin: 0; font-size: 1.1em; color: var(--dark);">${titleHeader}</h3>
                    <small style="color: #666;">${translations[currentLang].lbl_from_member} <b>${username}</b></small>
                </div>
            </div>
            <i class="fas fa-ellipsis-v" style="color: #ccc;"></i>
        </div>

        <div style="padding: 20px; max-width: 500px; margin: 0 auto; width: 100%; box-sizing: border-box; flex: 1;">
            
            <div style="display: flex; align-items: center; gap: 12px; padding: 18px; border-radius: 15px; border: 1px solid ${cardBorderColor}; margin-bottom: 25px; background: ${cardBgColor};">
                <div style="background: ${themeColor}; color: white; width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.3em;">
                    <i class="${mainIcon}"></i>
                </div>
                <div style="text-align: left; flex: 1;">
                    <div style="font-weight: bold; color: ${textStatusColor}; font-size: 1em;">${translations[currentLang].lbl_amount_type(type)}</div>
                    <div style="font-size: 1.2em; color: ${themeColor}; font-weight: bold;">${amount.toFixed(2)} ${currency}</div>
                </div>
            </div>

            ${withdrawInfoHtml}

            <div style="display: flex; gap: 15px; margin-bottom: 30px;">
                <button class="status-btn btn-reject" onclick="processAction('rejected', '${username}', ${amount}, '${type}', '${currency}')" style="flex: 1; padding: 16px; border-radius: 15px; font-weight: bold; cursor: pointer;">${translations[currentLang].btn_reject}</button>
                <button class="status-btn btn-approve" onclick="processAction('approved', '${username}', ${amount}, '${type}', '${currency}')" style="flex: 2; padding: 16px; border-radius: 15px; font-weight: bold; font-size: 1em; cursor: pointer; background: ${themeColor};">
                    <i class="fas fa-check-circle"></i> ${isWithdraw ? translations[currentLang].btn_confirm_transfer : translations[currentLang].btn_approve_topup}
                </button>
            </div>

            <div style="background: white; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border: 1px solid #eee; overflow: hidden; margin-bottom: 40px;">
                <div style="padding: 15px 20px; border-bottom: 1px solid #eee; font-weight: bold; color: var(--dark); display: flex; align-items: center; gap: 10px; background: #f8fafc;">
                    <i class="fas fa-comments" style="color: ${themeColor};"></i> ${translations[currentLang].lbl_chat_verify}
                </div>
                <div id="chat-box" style="height: 350px; overflow-y: auto; padding: 15px; background: #f1f5f9; display: flex; flex-direction: column; gap: 10px;"></div>
                <div style="padding: 15px; background: white; display: flex; gap: 10px; border-top: 1px solid #eee;">
                     <input type="file" id="admin-slip-input" hidden accept="image/*" onchange="handleAdminSlipUpload()">
                     <button onclick="document.getElementById('admin-slip-input').click()" style="background: #f1f5f9; border: none; width: 45px; height: 45px; border-radius: 10px; cursor: pointer;"><i class="fas fa-image"></i></button>
                     <input type="text" id="admin-chat-input" placeholder="${translations[currentLang].plh_chat_input}" style="flex:1; padding: 12px; border: 1px solid #e2e8f0; border-radius: 10px; outline: none;">
                     <button onclick="sendAdminMessage()" style="background: ${themeColor}; color: white; border: none; width: 45px; height: 45px; border-radius: 10px;"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
    </div>
    `;
    
    await loadAdminChatHistory(requestId);
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏¥‡∏î Modal (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å)
function closeFullChatModal() {
    const modal = document.getElementById('topup-full-modal');
    if (modal) {
        modal.remove(); // ‡∏•‡∏ö Modal ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
    }
    showContent('topup'); // ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ List ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô
}


//2.1
async function processAction(status, username, initialAmount = 0, type = 'TOPUP', currency = 'USD') {
    let finalAmount = initialAmount;
    const isWithdraw = type === 'WITHDRAW';
    
    // üö© ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Label ‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó
    const actionLabel = status === 'approved' 
        ? (isWithdraw ? translations[currentLang].action_approve_withdraw : translations[currentLang].action_approve_topup)
        : (isWithdraw ? translations[currentLang].action_reject_withdraw : translations[currentLang].action_reject_topup);

    if (status === 'approved') {
        const confirmMsg = isWithdraw 
            ? translations[currentLang].confirm_withdraw_final(username, initialAmount.toFixed(2), currency)
            : translations[currentLang].confirm_topup_final(username, currency);

        if (!isWithdraw) {
            const inputAmount = prompt(confirmMsg, initialAmount);
            if (inputAmount === null) return;
            finalAmount = parseFloat(inputAmount);
        } else {
            if (!confirm(confirmMsg)) return;
        }
    } else {
        if (!confirm(translations[currentLang].confirm_general_action(actionLabel))) return;
    }

    try {
        const res = await fetch('/api/admin/process-topup', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                requestId: currentChatRequestId, 
                status: status,
                finalAmount: finalAmount,
                adminName: localStorage.getItem('myUsername'),
                currency: currency 
            })
        });

        const data = await res.json();
        if (res.ok) {
            Swal.fire(translations[currentLang].swal_success, data.message, 'success');
            socket.emit('statusChanged', { requestId: currentChatRequestId, status: status });
            
            // üö© ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° System Message ‡πÉ‡∏ô‡πÅ‡∏ä‡∏ó
            const typeLabel = isWithdraw ? translations[currentLang].withdraw_type : translations[currentLang].topup_type;
            const sysMsg = {
                requestId: currentChatRequestId,
                sender: 'System',
                message: status === 'approved' 
                    ? translations[currentLang].sys_msg_success(typeLabel, finalAmount.toFixed(2), currency)
                    : translations[currentLang].sys_msg_rejected,
                type: 'system'
            };
            socket.emit('sendMessage', sysMsg);

            showContent('topup');
            updateBadges();
        } else {
            Swal.fire(translations[currentLang].swal_error, data.error || translations[currentLang].swal_error, 'error');
        }
    } catch (e) {
        Swal.fire('Error', translations[currentLang].err_server_connect, 'error');
    }
}



// 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò
async function processRequest(status) {
    const action = status === 'approved' 
		? translations[currentLang].action_approve 
		: translations[currentLang].action_reject;
    if (!confirm(translations[currentLang].confirm_generic(action))) return;

    try {
        const res = await fetch(`/api/admin/process-topup`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                requestId: currentChatRequestId, 
                status: status,
                adminName: localStorage.getItem('myUsername')
            })
        });

        if (res.ok) {
        // ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì Real-time ‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ User ‡πÄ‡∏î‡πâ‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
        socket.emit('statusChanged', { 
            requestId: currentChatRequestId, 
            status: status 
        });
        
        alert(translations[currentLang].alert_success);
        showContent('topup');
        }
    } catch (e) {
        alert("Unable to connect to the server.");
    }
}



// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≤‡∏Å‡∏ù‡∏±‡πà‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
function sendAdminMessage() {
    const input = document.getElementById('admin-chat-input');
    const message = input.value.trim();
    if (!message || !currentChatRequestId) return;

    const chatData = {
        requestId: currentChatRequestId,
        sender: localStorage.getItem('myUsername'),
        message: message,
        type: 'text'
    };

    socket.emit('sendMessage', chatData); // ‡∏™‡πà‡∏á‡πÑ‡∏õ Server
    appendAdminChatMessage(chatData);     // ‡πÅ‡∏™‡∏î‡∏á‡∏ù‡∏±‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    input.value = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ä‡∏ó‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
function appendAdminChatMessage(msg) {
    const chatBox = document.getElementById('chat-box');
    if (!chatBox) return;

    const isMe = msg.sender === localStorage.getItem('myUsername');
    
    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
    let contentHTML = "";
    if (msg.type === 'image') {
        contentHTML = `<img src="${msg.message}" style="max-width: 100%; border-radius: 10px; cursor: pointer; display: block;" onclick="window.open(this.src)">`;
    } else {
        contentHTML = `<p style="margin: 0; line-height: 1.5;">${msg.message}</p>`;
    }
	
	if (msg.type === 'system') {
    const sysHTML = `
        <div style="align-self: center; margin: 15px 0; background: #fff4e5; color: #663c00; padding: 8px 20px; border-radius: 20px; font-size: 0.85em; font-weight: bold; border: 1px solid #ffe7cc;">
            ${msg.message}
        </div>
    `;
    chatBox.innerHTML += sysHTML;
    chatBox.scrollTop = chatBox.scrollHeight; 
    return;
}

    const msgHTML = `
        <div style="display: flex; flex-direction: column; align-items: ${isMe ? 'flex-end' : 'flex-start'}; margin-bottom: 12px;">
            <div style="background: ${isMe ? 'var(--primary)' : 'white'}; 
                        color: ${isMe ? 'white' : 'var(--dark)'}; 
                        padding: ${msg.type === 'image' ? '5px' : '10px 15px'}; 
                        border-radius: ${isMe ? '15px 15px 0 15px' : '15px 15px 15px 0'}; 
                        max-width: 70%; 
                        box-shadow: 0 2px 4px rgba(0,0,0,0.05);
                        border: ${isMe ? 'none' : '1px solid #eee'};">
                ${contentHTML}
            </div>
            <small style="font-size: 0.7em; color: #94a3b8; margin-top: 3px;">
                ${isMe ? 'You (Admin)' : msg.sender}
            </small>
        </div>
    `;

    chatBox.innerHTML += msgHTML;
    chatBox.scrollTop = chatBox.scrollHeight;
}

// ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Socket ‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ appendAdminChatMessage
socket.on('receiveMessage', (msg) => {
    const myName = localStorage.getItem('myUsername');
    if (msg.sender === myName) return; // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡∏™‡πà‡∏á‡πÄ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏≤‡∏î‡∏ã‡πâ‡∏≥ (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏ß‡∏≤‡∏î‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏ï‡∏≠‡∏ô‡∏™‡πà‡∏á)

    // ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô (‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ)
    if (msg.requestId === currentChatRequestId) {
        if (typeof appendAdminChatMessage === "function") {
            appendAdminChatMessage(msg);
        }
    }

    // ‡∏Å‡∏£‡∏ì‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ç‡∏≠‡∏á‡πÅ‡∏ä‡∏ó KYC (‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ)
    if (msg.requestId === currentKYCRequestId) {
        if (typeof appendKYCChatMessage === "function") {
            appendKYCChatMessage(msg);
        }
    }
});

socket.on('notifyAdminNewRequest', (data) => {
    const myName = localStorage.getItem('myUsername');
    if (data.adminId === myName) {
        if (typeof loadTopupList === "function") {
            loadTopupList(); 
        } else {
            location.reload();
        }
    }
});


// 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏¢‡πà‡∏≠‡∏Ç‡∏ô‡∏≤‡∏î‡∏£‡∏π‡∏õ (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ù‡∏±‡πà‡∏á User)
async function compressImage(file, { maxWidth = 1024, quality = 0.7 }) {
    return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = (event) => {
            const img = new Image();
            img.src = event.target.result;
            img.onload = () => {
                const canvas = document.createElement('canvas');
                let width = img.width;
                let height = img.height;
                if (width > maxWidth) {
                    height = (maxWidth / width) * height;
                    width = maxWidth;
                }
                canvas.width = width;
                canvas.height = height;
                const ctx = canvas.getContext('2d');
                ctx.drawImage(img, 0, 0, width, height);
                canvas.toBlob((blob) => resolve(blob), 'image/jpeg', quality);
            };
        };
        reader.onerror = (error) => reject(error);
    });
}

// 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
async function handleAdminSlipUpload() {
    const fileInput = document.getElementById('admin-slip-input');
    const file = fileInput.files[0];
    if (!file || !currentChatRequestId) return;

    const btn = document.getElementById('admin-image-btn');
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>'; // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î

    try {
        // ‡∏¢‡πà‡∏≠‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á
        const compressedBlob = await compressImage(file, { maxWidth: 1024, quality: 0.7 });
        
        const formData = new FormData();
        formData.append('slip', compressedBlob, 'admin_receipt.jpg');

        // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á API ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ (Cloudinary - ‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå topup_slips)
        const res = await fetch('/api/upload-slip', {
            method: 'POST',
            body: formData
        });
        const data = await res.json();

        if (data.url) {
            const chatData = {
                requestId: currentChatRequestId,
                sender: localStorage.getItem('myUsername'),
                message: data.url,
                type: 'image'
            };
            // ‡∏™‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô Socket ‡πÅ‡∏•‡∏∞‡∏ß‡∏≤‡∏î‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô
            socket.emit('sendMessage', chatData);
            appendAdminChatMessage(chatData);
        }
    } catch (err) {
        console.error("Upload error:", err);
        alert("Image upload failed.");
    } finally {
        fileInput.value = '';
        btn.innerHTML = '<i class="fas fa-image"></i>';
    }
}





//=====KYC 
// ‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏Ç‡∏≠ KYC ‡πÉ‡∏´‡∏°‡πà
socket.on('admin-notification', (data) => {
	const myName = localStorage.getItem('myUsername');
	if (data.adminId !== myName) return;
    if (data.type === 'KYC_REQUEST') {
        updateBadges(); 
        
        let audio = new Audio('https://assets.mixkit.co/active_storage/sfx/2358/2358-preview.mp3');
        audio.play();
        
        // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡πà‡∏ß‡∏ô KYC ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
        const mainDisplay = document.getElementById('main-display');
        const kycInDisplay = mainDisplay.querySelector('#section-kyc-list');
        
        // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠ section-kyc-list ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏´‡∏•‡∏±‡∏Å (‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ) ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
        if (kycInDisplay && kycInDisplay.style.display !== 'none') {
            loadKYCRequests(); 
        }
    }
});

async function loadKYCRequests() {
    const container = document.getElementById('kyc-list-container');
    container.innerHTML = '<div style="text-align:center; padding:20px;"><i class="fas fa-spinner fa-spin"></i> Retrieving request data...</div>';

    try {
        const adminName = localStorage.getItem('myUsername');
        const res = await fetch(`/api/admin/kyc-list?admin=${adminName}`);
        const requests = await res.json();

        if (requests.length === 0) {
            container.innerHTML = '<div style="text-align:center; margin-top:50px; color:#999;"><i class="fas fa-user-shield fa-3x"></i><p>There are no new identity verification requests.</p></div>';
            return;
        }

        // 1. ‡∏î‡∏∂‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏°‡∏≤‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Promise ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏≤‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
        const getPosition = () => {
            return new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(resolve, reject);
            });
        };

        let adminPos = null;
        try {
            // ‡∏£‡∏≠‡∏û‡∏¥‡∏Å‡∏±‡∏î 1.5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≤‡∏°‡πÑ‡∏õ‡πÇ‡∏ä‡∏ß‡πå‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô
            adminPos = await Promise.race([
                getPosition(),
                new Promise((_, reject) => setTimeout(() => reject(new Error('Timeout')), 1500))
            ]);
        } catch (e) {
            console.log("‡∏¢‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏õ‡∏¥‡∏î GPS");
        }

        container.innerHTML = requests.map(req => {
            let distanceText = "‡∏£‡∏≠‡∏û‡∏¥‡∏Å‡∏±‡∏î...";
            let distanceVal = 0;
            let isClose = false;

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÑ‡∏´‡∏°
            if (adminPos && req.coords) {
                distanceVal = calculateDistance(
                    adminPos.coords.latitude, 
                    adminPos.coords.longitude, 
                    req.coords.lat, 
                    req.coords.lng
                );
                distanceText = `far ${distanceVal.toFixed(1)} ‡∏°.`;
                isClose = distanceVal <= 20;
            }

            // ‡πÉ‡∏ä‡πâ encodeURIComponent ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏û‡∏¥‡πÄ‡∏®‡∏©‡πÉ‡∏ô JSON
            const dataStr = encodeURIComponent(JSON.stringify(req));

            return `
            <div class="admin-card" onclick="viewKYCDetail('${dataStr}')" style="cursor:pointer; transition: 0.2s; position: relative; display: flex; justify-content: space-between; align-items: center; padding: 15px; border-radius: 12px; border: 1px solid #eee; margin-bottom: 10px; background: white;">
                <div style="display: flex; gap: 12px; align-items: center; flex: 1;">
                    <img src="${req.userImg || 'https://via.placeholder.com/60'}" style="width: 50px; height: 50px; border-radius: 10px; object-fit: cover; border: 1px solid #ddd;">
                    <div style="text-align: left;">
                        <strong style="font-size: 1em; color: var(--dark);">${req.fullName}</strong><br>
                        <small style="color: ${isClose ? 'var(--primary)' : '#666'}; font-weight: bold;">
                            <i class="fas fa-map-marker-alt"></i> ${distanceText}
                        </small>
                    </div>
                </div>
                <div style="color: var(--primary); font-size: 0.85em; font-weight: bold; white-space: nowrap;">
                    Check the information <i class="fas fa-chevron-right" style="font-size: 0.8em; margin-left: 5px;"></i>
                </div>
            </div>`;
        }).join('');

    } catch (err) {
        console.error("Load KYC Error:", err);
        container.innerHTML = '<p style="text-align:center; color:red; padding:20px;">Data loading error or server failure.</p>';
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Haversine ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á‡∏û‡∏¥‡∏Å‡∏±‡∏î 2 ‡∏à‡∏∏‡∏î
function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371000; // ‡∏£‡∏±‡∏®‡∏°‡∏µ‡πÇ‡∏•‡∏Å (‡πÄ‡∏°‡∏ï‡∏£)
    const dLat = (lat2 - lat1) * Math.PI / 180;
    const dLon = (lon2 - lon1) * Math.PI / 180;
    const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
              Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
              Math.sin(dLon/2) * Math.sin(dLon/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return R * c;
}

function viewKYCFullImage(src) {
    document.getElementById('kyc-modal-img').src = src;
    document.getElementById('kyc-image-modal').style.display = 'flex';
}


// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î Modal ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
function viewKYCDetail(dataStr) {
    const data = JSON.parse(decodeURIComponent(dataStr));
    currentKYCRequestId = data.username; 
    const modal = document.getElementById('admin-kyc-detail-modal');
    
    // 1. ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á‡πÉ‡∏ô‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏ï‡πà‡∏≤‡∏á‡πÜ
    document.getElementById('det-user-img').style.backgroundImage = `url(${data.userImg})`;
    document.getElementById('det-name').innerText = data.fullName;
    document.getElementById('det-id').innerText = data.idNumber;
    document.getElementById('det-phone').innerText = data.phone;
    document.getElementById('det-username').innerText = `@${data.username}`;
    document.getElementById('det-address').innerText = data.address;
    
    // 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á
    window.updateModalDistance = () => {
        navigator.geolocation.getCurrentPosition((pos) => {
            const dist = calculateDistance(pos.coords.latitude, pos.coords.longitude, data.coords.lat, data.coords.lng);
            const isClose = dist <= 20;
            
            const distElem = document.getElementById('det-distance');
            const titleElem = document.getElementById('det-title');
            const badgeElem = document.getElementById('det-status-badge');
            const btnApprove = document.getElementById('btn-det-approve');

            distElem.innerHTML = `<i class="fas fa-map-marker-alt"></i> ${translations[currentLang].lbl_current_dist(dist.toFixed(1))}`;

            if (isClose) {
                titleElem.innerText = translations[currentLang].status_ready;
                badgeElem.style.background = "#e8f5e9";
                badgeElem.style.borderColor = "#c8e6c9";
                btnApprove.style.background = "var(--primary)"; 
            } else {
                titleElem.innerText = translations[currentLang].status_too_far;
                badgeElem.style.background = "#fff3e0";
                badgeElem.style.borderColor = "#ffe0b2";
                btnApprove.style.background = "#94a3b8";
            }
        });
    };

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î
    updateModalDistance();

    // 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏î
    document.getElementById('btn-det-approve').onclick = () => { 
        checkDistanceBeforeApprove(data._id, data.username, data.coords.lat, data.coords.lng); 
    };
    
    document.getElementById('btn-det-reject').onclick = () => { 
        deleteKYCRequest(data._id, data.username); 
    };

    modal.scrollTop = 0;
    modal.style.display = 'block';
    
    document.getElementById('kyc-chat-box').innerHTML = '<div style="text-align:center; padding:10px; color:#999; font-size:0.8em;">Loading chat history...</div>';
    loadKYCChatHistory(data.username); 
    socket.emit('joinRequest', data.username); 
}

function closeKYCDetail() {
    document.getElementById('admin-kyc-detail-modal').style.display = 'none';
}


// 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÇ‡∏´‡∏•‡∏î‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡πÅ‡∏ä‡∏ó KYC
async function loadKYCChatHistory(requestId) {
    try {
        const res = await fetch(`/api/kyc/chat-history?requestId=${requestId}`);
        const history = await res.json();
        const chatBox = document.getElementById('kyc-chat-box');
        chatBox.innerHTML = '';
        
        if (Array.isArray(history)) {
            history.forEach(msg => appendKYCChatMessage(msg));
        }
    } catch (err) {
        console.error("Load KYC chat error:", err);
    }
}

// 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
function sendKYCAdminMessage() {
    const input = document.getElementById('kyc-admin-input');
    const message = input.value.trim();
    if (!message || !currentKYCRequestId) return;

    const chatData = {
        requestId: currentKYCRequestId,
        sender: localStorage.getItem('myUsername'),
        message: message,
        type: 'text',
        category: 'kyc' 
    };

    socket.emit('sendMessage', chatData);
    appendKYCChatMessage(chatData);
    input.value = '';
}

// 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ß‡∏≤‡∏î‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
function appendKYCChatMessage(msg) {
    const chatBox = document.getElementById('kyc-chat-box');
    if (!chatBox) return;

    const isMe = msg.sender === localStorage.getItem('myUsername');
    
    const msgHTML = `
        <div style="display: flex; flex-direction: column; align-items: ${isMe ? 'flex-end' : 'flex-start'}; margin-bottom: 8px;">
            <div style="background: ${isMe ? 'var(--primary)' : 'white'}; 
                        color: ${isMe ? 'white' : 'var(--dark)'}; 
                        padding: 8px 12px; border-radius: 12px; 
                        max-width: 85%; font-size: 0.9em;
                        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                        border: ${isMe ? 'none' : '1px solid #e2e8f0'};">
                ${msg.message}
            </div>
            <small style="font-size: 0.6em; color: #94a3b8; margin-top: 2px; padding: 0 5px;">
                ${isMe ? 'You' : msg.sender} ‚Ä¢ ${new Date(msg.timestamp || new Date()).toLocaleTimeString('th-TH', {hour: '2-digit', minute:'2-digit'})}
            </small>
        </div>
    `;
    chatBox.insertAdjacentHTML('beforeend', msgHTML);
    chatBox.scrollTop = chatBox.scrollHeight;
}

async function deleteKYCRequest(requestId, username) {
    if (!confirm(translations[currentLang].confirm_delete_request(username))) {
		return;
	}

    try {
        const res = await fetch('/api/admin/delete-kyc', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ requestId, username })
        });

        const data = await res.json();

        if (data.success) {
            alert(translations[currentLang].alert_delete_success);
            closeKYCDetail(); 
            loadKYCRequests();
            updateBadges(); 
        } else {
            alert("An error occurred: " + data.error);
        }
    } catch (err) {
        console.error(err);
        alert("Unable to connect to the server.");
    }
}


// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Å‡∏£‡∏∞‡∏¢‡∏∞‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
async function checkDistanceBeforeApprove(requestId, username, memberLat, memberLng) {
    const adminName = localStorage.getItem('myUsername');
    
    Swal.fire({ 
        title: translations[currentLang].swal_check_gps,
        allowOutsideClick: false,
        target: document.getElementById('admin-kyc-detail-modal'),
        didOpen: () => Swal.showLoading() 
    });

    navigator.geolocation.getCurrentPosition(async (pos) => {
        const adminLat = pos.coords.latitude;
        const adminLng = pos.coords.longitude;
        
        // 2. ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á
        const dist = calculateDistance(adminLat, adminLng, memberLat, memberLng);
        const isPass = dist <= 20;

        // 3. ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ú‡∏•‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
        Swal.fire({
            title: isPass ? translations[currentLang].swal_dist_pass : translations[currentLang].swal_dist_fail,
            html: `Current distance: <b>${dist.toFixed(1)} m</b><br>${isPass ? '<span style="color:green">Stay within the specified 20-meter radius </span>' : '<span style="color:red">You are more than 20 meters away.</span>'}`,
            icon: isPass ? 'success' : 'warning',
			target: document.getElementById('admin-kyc-detail-modal'),
            showCancelButton: true,
            confirmButtonText: translations[currentLang].swal_btn_confirm,
			cancelButtonText: translations[currentLang].swal_btn_cancel,
            confirmButtonColor: isPass ? '#11998e' : '#94a3b8',
        }).then((result) => {
            if (result.isConfirmed) {
				if (!isPass) {
				return Swal.fire({
					title: translations[currentLang].swal_title_denied,
					text: translations[currentLang].swal_text_denied,
					icon: 'error',
					target: document.getElementById('admin-kyc-detail-modal')
				});
			}
    executeApprove(requestId, username, adminName);
}
        });
    }, (err) => {
        Swal.fire({
            title: translations[currentLang].swal_title_gps_err,
			text: translations[currentLang].swal_text_gps_err,
            icon: 'error',
            target: document.getElementById('admin-kyc-detail-modal')
        });
    });
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á API ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥
async function executeApprove(requestId, username, adminName) {
    try {
        const res = await fetch('/api/admin/approve-kyc', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ requestId, username, adminName })
        });
        if (res.ok) {
            Swal.fire({
                title: translations[currentLang].swal_title_success,
				text: translations[currentLang].swal_text_success,
                icon: 'success',
                target: document.getElementById('admin-kyc-detail-modal')
            }).then(() => {
                closeKYCDetail();
                loadKYCRequests();
            });
        }
    } catch (e) { console.error(e); }
}


async function loadMemberList() {
    const container = document.getElementById('members-list-container');
    const search = document.getElementById('member-search-input').value;
    const filterStatus = document.getElementById('member-filter-status').value;
    const adminName = localStorage.getItem('myUsername');
    
    container.innerHTML = '<p style="text-align:center; color:#999; padding:20px;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å...</p>';

    try {
        const res = await fetch(`/api/users-list?requestBy=${adminName}&search=${search}&limit=100`);
        const data = await res.json();
        let members = data.users;

        // ‚úÖ ‡∏Å‡∏£‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ô‡∏ù‡∏±‡πà‡∏á Frontend
        if (filterStatus === 'kyc') {
            members = members.filter(u => u.isVerified === true);
        } else if (filterStatus === 'not_kyc') {
            members = members.filter(u => u.isVerified !== true);
        } else if (filterStatus === 'banned') {
            members = members.filter(u => u.isBanned === true);
        }

        if (!members || members.length === 0) {
            container.innerHTML = '<p style="text-align:center; color:#999; padding:20px;">No members were found matching the selected criteria</p>';
            return;
        }

        // ‡∏ß‡∏≤‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å (Map ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°)
        container.innerHTML = members.map(user => {
            const username = user.name;
            const coins = user.coins || 0;
            const relation = user.relationType;

            return `
                <div class="admin-card" style="display: flex; align-items: center; gap: 15px; padding: 15px; border-left: 5px solid ${user.isBanned ? 'var(--danger)' : (relation === 'OWNED' ? 'var(--primary)' : '#f1c40f')};">
                    <img src="${user.profileImg || 'https://via.placeholder.com/50'}" 
                         style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover; border: 2px solid #eee; opacity: ${user.isBanned ? '0.5' : '1'};">
                    
                    <div style="flex: 1;">
                        <div style="display:flex; align-items:center; gap:5px;">
                            <strong style="font-size: 1em; color: ${user.isBanned ? 'var(--danger)' : 'var(--dark)'};">${username}</strong>
                            ${user.isVerified ? '<i class="fas fa-check-circle" style="color:var(--primary); font-size:0.8em;"></i>' : ''}
                            ${user.isBanned ? '<small style="background:#ffebee; color:red; padding:1px 5px; border-radius:5px; font-size:0.6em;">BANNED</small>' : ''}
                        </div>
                        <div style="font-size: 0.8em; color: var(--primary); font-weight: bold;">
							Balance: ${user.coins.toFixed(2)} ${user.currency || zoneCurrency}
						</div>
                    </div>

                    <div style="display: flex; flex-direction: column; gap: 5px;">
                        <button onclick="viewUserProfile('${username}')" 
                                style="border: none; background: #f1f5f9; color: var(--dark); padding: 8px 15px; border-radius: 10px; font-size: 0.85em; cursor: pointer; font-family:'Kanit'; font-weight:bold;">
                            <i class="fas fa-search"></i> Profile
                        </button>
                    </div>
                </div>
            `;
        }).join('');

    } catch (err) {
        container.innerHTML = '<p style="text-align:center; color:red;">Unable to connect.</p>';
    }
}


async function viewUserProfile(username) {
    Swal.fire({
        title: 'Retrieving profile data...',
        target: document.getElementById('user-profile-modal'),
        allowOutsideClick: false,
        didOpen: () => Swal.showLoading()
    });

    try {
        const adminName = localStorage.getItem('myUsername');
        // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡πà‡∏≤‡∏ô API ‡πÄ‡∏î‡∏¥‡∏°
        const res = await fetch(`/api/users-list?requestBy=${adminName}&search=${username}`);
        const data = await res.json();
        const user = data.users.find(u => u.name === username);

        if (!user) {
            Swal.fire({ title: 'User not found.', icon: 'error', target: document.getElementById('user-profile-modal') });
            return;
        }

        Swal.close();
        const content = document.getElementById('user-profile-content');
        
        // ‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• KYC (‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà Verified ‡πÅ‡∏•‡πâ‡∏ß)
        let kycHtml = "";
        if (user.isVerified) {
            kycHtml = `
                <div style="background: #e8f5e9; border-radius: 20px; padding: 20px; border: 1px solid #c8e6c9; margin-bottom: 25px;">
                    <h4 style="margin: 0 0 15px 0; color: #2e7d32; font-size: 1em;">
                        <i class="fas fa-id-card"></i> Identity verification information
                    </h4>
                    <div style="display: grid; gap: 10px; font-size: 0.9em;">
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">National ID number:</span>
                            <b>${user.idNumber || '-'}</b>
                        </div>
                        <div style="display: flex; justify-content: space-between;">
                            <span style="color: #666;">telephone number:</span>
                            <b>${user.phone || '-'}</b>
                        </div>
                        <div style="border-top: 1px solid #c8e6c9; padding-top: 10px;">
                            <small style="color: #666;">Current address:</small>
                            <div style="font-weight: bold; margin-top: 2px;">${user.address || '-'}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        content.innerHTML = `
            <div style="text-align: center; margin-bottom: 25px;">
                <div style="position: relative; display: inline-block;">
                    <img src="${user.profileImg || 'https://via.placeholder.com/120'}" 
                         style="width: 110px; height: 110px; border-radius: 50%; object-fit: cover; border: 4px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                    ${user.isVerified ? '<div style="position: absolute; bottom: 0; right: 0; background: var(--primary); color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid white;"><i class="fas fa-check" style="font-size: 0.8em;"></i></div>' : ''}
                </div>
                <h3 style="margin: 15px 0 5px;">@${user.name}</h3>
                <div style="color: #f1c40f; font-weight: bold;">
                    <i class="fas fa-star"></i> ${user.rating.toFixed(1)} 
                    <span style="color: #94a3b8; font-weight: normal; font-size: 0.8em;">(${user.ratingCount} review)</span>
                </div>
                <p style="color: #64748b; font-size: 0.9em; margin-top: 5px;">${user.fullName || 'Name not yet specified.'}</p>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 25px;">
                <div style="background: #f8fafc; padding: 12px; border-radius: 12px; text-align: center; border: 1px solid #eee;">
                    <div style="font-size: 0.7em; color: #94a3b8; text-transform: uppercase;">Post</div>
                    <div style="font-weight: bold; font-size: 1.1em;">${user.totalPosts}</div>
                </div>
                <div style="background: #f8fafc; padding: 12px; border-radius: 12px; text-align: center; border: 1px solid #eee;">
                    <div style="font-size: 0.7em; color: #94a3b8; text-transform: uppercase;">Job</div>
                    <div style="font-weight: bold; font-size: 1.1em;">${user.totalJobs}</div>
                </div>
                <div style="background: #e8f5e9; padding: 12px; border-radius: 12px; text-align: center; border: 1px solid #c8e6c9;">
                    <div style="font-size: 0.7em; color: #2e7d32; text-transform: uppercase;">Success</div>
                    <div style="font-weight: bold; font-size: 1.1em; color: #2e7d32;">${user.completedJobs}</div>
                </div>
            </div>

            <div style="background: white; padding: 15px; border-radius: 15px; border: 1px solid #eee; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center;">
    <span style="color: #666;">
    <i class="fas fa-coins" style="color: #f1c40f;"></i> 
    <span data-i18n-key="lbl_balance">‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠</span>
</span>
    <b style="font-size: 1.2em; color: var(--primary);">
        ${user.coins.toFixed(2)} ${user.currency || zoneCurrency || 'USD'}
    </b>
</div>

            ${kycHtml}

            <div style="padding-bottom: 30px;">
                <button onclick="manageUserBan('${user.name}', ${user.isBanned})" 
                        style="width: 100%; padding: 15px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; font-family: 'Kanit';
                        background: ${user.isBanned ? 'var(--primary)' : '#ffebee'}; 
                        color: ${user.isBanned ? 'white' : '#c62828'};">
                    <i class="fas fa-ban"></i> ${user.isBanned ? 'Un ban' : 'BAN'}
                </button>
            </div>
        `;

        document.getElementById('user-profile-modal').style.display = 'block';

    } catch (err) {
        console.error(err);
        Swal.fire({ title: 'An error occurred.', text: 'Unable to load profile information.', icon: 'error', target: document.getElementById('user-profile-modal') });
    }
}

function closeUserProfile() {
    document.getElementById('user-profile-modal').style.display = 'none';
}


// ‚úÖ 1. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÅ‡∏ö‡∏ô (1, 3, 7, 15, 30 ‡∏´‡∏£‡∏∑‡∏≠‡∏ñ‡∏≤‡∏ß‡∏£)
async function manageUserBan(username, isCurrentlyBanned) {
    if (isCurrentlyBanned) {
        const result = await Swal.fire({
            title: 'Un ban?',
            text: `Do you want to be unbanned @${username} Is it right?`,
            icon: 'question',
            showCancelButton: true,
            confirmButtonText: 'Yes, Un ban',
            cancelButtonText: 'Cancle',
            target: document.getElementById('user-profile-modal')
        });

        if (result.isConfirmed) {
            executeBanAction(username, 0); // 0 = ‡∏õ‡∏•‡∏î‡πÅ‡∏ö‡∏ô
        }
    } else {
        const { value: days } = await Swal.fire({
            title: `Ban!!! @${username}`,
            input: 'select',
            inputOptions: {
                '1': '1 Day',
                '3': '3 Day',
                '7': '7 Day',
                '15': '15 Day',
                '30': '30 Day',
                '9999': 'permanent'
            },
            inputPlaceholder: 'Select the ban duration.',
            showCancelButton: true,
            confirmButtonText: 'Confirm',
            cancelButtonText: 'Cancel',
            confirmButtonColor: '#e74c3c',
			target: document.getElementById('user-profile-modal'),
            inputValidator: (value) => {
                if (!value) return 'Please select a duration.'
            }
        });

        if (days) {
            executeBanAction(username, parseInt(days));
        }
    }
}

// ‚úÖ 2. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏ó‡∏µ‡πà Server (‡πÉ‡∏ä‡πâ API /api/admin/toggle-ban ‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì)
async function executeBanAction(username, days) {
    Swal.fire({ 
			title: 'In progress...',
			target: document.getElementById('user-profile-modal'),
			didOpen: () => Swal.showLoading() });

    try {
        const adminName = localStorage.getItem('myUsername');
        const res = await fetch('/api/admin/toggle-ban', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                targetUser: username,
                shouldBan: days > 0, // ‡∏ñ‡πâ‡∏≤‡∏™‡πà‡∏á‡∏ß‡∏±‡∏ô‡∏°‡∏≤‡∏Ñ‡∏∑‡∏≠‡πÅ‡∏ö‡∏ô (true) ‡∏ñ‡πâ‡∏≤ 0 ‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏•‡∏î‡πÅ‡∏ö‡∏ô (false)
                requestBy: adminName,
                banDays: days,
                lang: 'th'
            })
        });

        const data = await res.json();
        if (res.ok && data.success) {
            Swal.fire('Success', days > 0 ? 'The account has been successfully deactivated' : 'The ban has been lifted', 'success').then(() => {
                closeUserProfile(); // ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                loadMemberList();   // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
            });
        } else {
            Swal.fire('The action cannot be performed.', data.error || 'An error occurred.', 'error');
        }
    } catch (err) {
        console.error(err);
        Swal.fire('An error occurred', 'Unable to connect to the server.', 'error');
    }
}

//‡πÅ‡∏õ‡∏•‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
async function fetchAdminZoneInfo(username) {
    try {
        const res = await fetch(`/api/admin/my-zone-info?admin=${username}`);
        const data = await res.json();
        
        if(data.success) {
            currentZoneId = data.zone.id;
            zoneCurrency = data.zone.zoneCurrency; 
            zoneRate = data.zone.zoneExchangeRate;
            const usdtElem = document.getElementById('sidebar-usdt-balance');
            if(usdtElem) usdtElem.innerText = data.adminCoins.toFixed(2);
            const zoneBalanceElem = document.getElementById('sidebar-zone-balance');
            if(zoneBalanceElem) {
                zoneBalanceElem.innerText = data.zoneWallet.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                });
            }
            const currencyLabel = document.getElementById('sidebar-zone-currency-label');
            if(currencyLabel) currencyLabel.innerText = zoneCurrency;
            const zoneCurrencyElem = document.getElementById('sidebar-zone-currency');
            if(zoneCurrencyElem) zoneCurrencyElem.innerText = zoneCurrency;
        }
    } catch (e) { 
        console.error("Zone data loading failed.", e); 
    }
}


// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏á‡∏¥‡∏ô
async function openExchangeModal() {
    if (!currentZoneId) {
        Swal.fire('An error occurred', 'No information was found for the zone you are responsible for.', 'error');
        return;
    }

    const adminName = localStorage.getItem('myUsername');

    try {
        // 1. ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (‡∏¢‡∏≠‡∏î coins ‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô)
        const res = await fetch(`/api/admin/get-zone-detail/${currentZoneId}?adminId=${adminName}`);
        const data = await res.json();
        
        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÑ‡∏´‡∏°
        if (!data.success) throw new Error(data.message);

        // 2. ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ (‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å data.admin.usdtBalance ‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡πà‡∏á‡∏°‡∏≤)
        const myUsdt = data.admin.usdtBalance || 0; 

        const { value: usdtAmount } = await Swal.fire({
            title: 'Convert USDT This is money within the zone.',
            html: `
                <div style="text-align:left; font-family:'Kanit',sans-serif;">
                    <p><b>Current rate:</b> 1 USDT = ${zoneRate} ${zoneCurrency}</p>
                    <p><b>Your coin balance:</b> <span style="color:var(--primary)">${myUsdt.toFixed(2)} USDT</span></p>
                    <hr>
                    <label>amount USDT to be converted:</label>
                    <input id="ex-usdt" type="number" step="0.01" class="swal2-input" placeholder="0.00" style="width:100%; margin:10px 0;">
                    <div id="ex-preview" style="background:#f1f5f9; padding:10px; border-radius:10px; text-align:center; font-weight:bold; color:var(--primary);">
                        You will receive: 0.00 ${zoneCurrency}
                    </div>
                </div>
            `,
            didOpen: () => {
                const input = document.getElementById('ex-usdt');
                input.addEventListener('input', () => {
                    const val = parseFloat(input.value) || 0;
                    document.getElementById('ex-preview').innerText = `You will receive: ${(val * zoneRate).toLocaleString()} ${zoneCurrency}`;
                });
            },
            showCancelButton: true,
            confirmButtonText: 'Confirm',
            cancelButtonText: 'Cancel',
            confirmButtonColor: 'var(--primary)',
            preConfirm: () => {
                const val = parseFloat(document.getElementById('ex-usdt').value);
                if (!val || val <= 0 || val > myUsdt) {
                    Swal.showValidationMessage('The amount is incorrect or there is insufficient USDT.');
                }
                return val;
            }
        });

        if (usdtAmount) {
            executeExchange(usdtAmount);
        }
    } catch (e) {
        console.error(e);
        Swal.fire('failed', 'Unable to retrieve the latest balance.', 'error');
    }
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡∏´‡∏•‡∏±‡∏á‡∏ö‡πâ‡∏≤‡∏ô
async function executeExchange(amount) {
    const adminName = localStorage.getItem('myUsername');

    try {
        Swal.fire({
            title: 'In progress...',
            allowOutsideClick: false,
            didOpen: () => Swal.showLoading()
        });

        const response = await fetch('/api/admin/convert-currency', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                adminId: adminName,     // ‡∏™‡πà‡∏á Username
                usdtToConvert: amount,  // ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô USDT (coins) ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏•‡∏Å
                zoneId: currentZoneId   // ‡∏£‡∏´‡∏±‡∏™‡πÇ‡∏ã‡∏ô
            })
        });

        const result = await response.json();

        if (result.success) {
            Swal.fire({
                icon: 'success',
                title: 'Currency conversion successful.!',
                text: `receive ${result.received.toLocaleString()} ${result.currency} success`,
                confirmButtonColor: 'var(--primary)'
            }).then(() => {
                // ‡∏£‡∏µ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏ã‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏ô Sidebar ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
                fetchAdminZoneInfo(adminName); 
            });
        } else {
            Swal.fire('failed', result.message, 'error');
        }
    } catch (err) {
        Swal.fire('Error', 'Unable to connect to the server.', 'error');
    }
}



socket.on('kyc-location-updated', (data) => {
    if (currentKYCRequestId === data.username) {
        if (typeof updateModalDistance === "function") updateModalDistance();
        loadKYCRequests(); // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≤‡∏á‡∏´‡∏•‡∏±‡∏á‡∏î‡πâ‡∏ß‡∏¢
    }
});




    </script>
	
	
	
<div id="hidden-storage" style="display: none;">
        
        <div id="section-topup-list">
            <div id="topup-list-container">
            </div>
        </div>

        <div id="section-admin-chat" style="display: none;">
            <button onclick="showContent('topup')" style="background: none; border: none; color: var(--primary); cursor: pointer; margin-bottom: 15px;" data-i18n-key="btn_back_to_requests">
				<i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏Ç‡∏≠
			</button>

            <div id="chat-box" style="background: #f1f3f5; padding: 20px; border-radius: 15px; height: 400px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px;">
            </div>

            <div style="margin-top: 15px; display: flex; gap: 10px;">
                <button class="status-btn btn-reject" style="flex: 1; padding: 15px;" onclick="processRequest('rejected')" data-i18n-key="btn_reject_kyc">‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò‡∏Ñ‡∏≥‡∏Ç‡∏≠</button>
				<button class="status-btn btn-approve" style="flex: 1; padding: 15px;" onclick="processRequest('approved')" data-i18n-key="btn_approve_kyc">‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏á‡∏¥‡∏ô</button>
            </div>
        </div>
        
        <div id="section-kyc-list" style="display: none;">
            <div id="kyc-list-container" style="display: flex; flex-direction: column; gap: 15px;">
            </div>
        </div>

    </div> 
    <div id="kyc-image-modal" class="modal" onclick="this.style.display='none'" style="display:none; position:fixed; z-index:100000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.9); align-items:center; justify-content:center;">
        <img id="kyc-modal-img" src="" style="max-width:95%; max-height:95%; border-radius:10px; box-shadow:0 0 20px rgba(255,255,255,0.2);">
        <div style="position:absolute; top:20px; right:20px; color:white; font-size:2em; cursor:pointer;"><i class="fas fa-times"></i></div>
    </div>

    <div id="admin-kyc-detail-modal" class="modal" style="display: none; position: fixed; z-index: 10001; left: 0; top: 0; width: 100%; height: 100%; background: white; overflow-y: auto;">
        
        <div style="position: sticky; top: 0; background: white; z-index: 10; padding: 15px 20px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #eee;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <button onclick="closeKYCDetail()" style="border: none; background: #f1f5f9; width: 40px; height: 40px; border-radius: 50%; cursor: pointer;">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3 style="margin: 0; font-size: 1.1em; color: var(--dark);" data-i18n-key="title_kyc_detail">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</h3>
            </div>
            <i class="fas fa-ellipsis-v" style="color: #ccc;"></i>
        </div>

        <div style="padding: 20px; max-width: 500px; margin: 0 auto;">
            
            <div id="det-user-img" style="width: 100%; height: 350px; background-size: cover; background-position: center; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 20px; position: relative; border: 4px solid #fff;">
                <div style="position: absolute; bottom: 15px; left: 15px; background: rgba(0,0,0,0.6); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.8em; backdrop-filter: blur(5px);" data-i18n-key="lbl_current_photo">
				<i class="fas fa-camera"></i> ‡∏£‡∏π‡∏õ‡∏ñ‡πà‡∏≤‡∏¢‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
				</div>
            </div>

            <div id="det-status-badge" style="display: flex; align-items: center; gap: 12px; padding: 18px; border-radius: 15px; border: 1px solid #c8e6c9; margin-bottom: 25px; background: #e8f5e9;">
                <div id="det-icon-bg" style="background: #2e7d32; color: white; width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 1.3em;">
                    <i class="fas fa-check-double"></i>
                </div>
                <div style="text-align: left; flex: 1;">
				<div id="det-title" style="font-weight: bold; color: #2e7d32; font-size: 1em;" data-i18n-key="status_pending">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</div>
				<div id="det-distance" style="font-size: 0.85em; color: #4caf50; font-weight: bold;" data-i18n-key="lbl_dist_from_you">‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì: 0.0 ‡πÄ‡∏°‡∏ï‡∏£</div>
				</div>
                <i class="fas fa-shield-alt" style="color: #2e7d32; font-size: 1.5em; opacity: 0.5;"></i>
            </div>

            <div style="background: #f8fafc; border-radius: 20px; padding: 20px; margin-bottom: 30px; border: 1px solid #e2e8f0;">
    <h4 style="margin: 0 0 15px; color: var(--dark); border-bottom: 2px solid #eee; padding-bottom: 8px;" data-i18n-key="lbl_member_info_header">
        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
    </h4>

    <div style="display: grid; gap: 15px;">
        <div>
            <small style="color: #94a3b8; display: block;" data-i18n-key="lbl_full_name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</small>
            <span id="det-name" style="font-weight: bold; font-size: 1.1em;">-</span>
        </div>

        <div>
            <small style="color: #94a3b8; display: block;" data-i18n-key="lbl_id_card">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</small>
            <span id="det-id" style="font-weight: bold;">-</span>
        </div>

        <div style="display: flex; gap: 20px;">
            <div style="flex: 1;">
                <small style="color: #94a3b8; display: block;" data-i18n-key="lbl_phone">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</small>
                <span id="det-phone" style="font-weight: bold;">-</span>
            </div>
            <div style="flex: 1;">
                <small style="color: #94a3b8; display: block;" data-i18n-key="lbl_username">Username</small>
                <span id="det-username" style="font-weight: bold; color: var(--primary);">-</span>
            </div>
        </div>

        <div>
            <small style="color: #94a3b8; display: block;" data-i18n-key="lbl_geo_address">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏≤‡∏°‡∏û‡∏¥‡∏Å‡∏±‡∏î</small>
            <span id="det-address" style="font-size: 0.9em; color: #475569;">-</span>
        </div>
    </div>
</div>

            <div style="display: flex; gap: 15px; padding-bottom: 30px;">
			<button id="btn-det-reject" class="status-btn btn-reject" style="flex: 1; padding: 16px; border-radius: 15px; font-weight: bold;" data-i18n-key="btn_kyc_reject">
			‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò
			</button>
			<button id="btn-det-approve" class="status-btn btn-approve" style="flex: 2; padding: 16px; border-radius: 15px; font-weight: bold; font-size: 1em;" data-i18n-key="btn_kyc_approve">
			<i class="fas fa-check-circle"></i> ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
			</button>
			</div>
        </div>
        
        
        <div style="padding: 15px 20px; border-bottom: 1px solid #eee; font-weight: bold; color: var(--dark); display: flex; align-items: center; gap: 10px;">
			<i class="fas fa-comments" style="color: var(--primary);"></i> 
			<span data-i18n-key="lbl_chat_appointment">‡πÅ‡∏ä‡∏ó‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏Å‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å</span>
			</div>
            
            <div id="kyc-chat-box" style="height: 300px; overflow-y: auto; padding: 15px; background: #f1f5f9; display: flex; flex-direction: column; gap: 10px;">
                <div style="align-self: center; background: #fff; padding: 5px 15px; border-radius: 20px; font-size: 0.75em; color: #94a3b8; border: 1px solid #e2e8f0;" data-i18n-key="msg_start_chat_kyc">
				‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏î‡∏û‡∏ö‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô
				</div>
            </div>

            <div style="padding: 15px; background: white; display: flex; gap: 10px; border-top: 1px solid #eee;">
    <input type="file" id="admin-slip-input" hidden accept="image/*" onchange="handleAdminSlipUpload()">
    
    <button id="admin-image-btn" onclick="document.getElementById('admin-slip-input').click()" style="background: #f1f5f9; border: none; width: 45px; height: 45px; border-radius: 10px; cursor: pointer;">
        <i class="fas fa-image"></i>
    </button>

    <input type="text" id="admin-chat-input" placeholder="Text..." style="flex:1; padding: 12px; border: 1px solid #e2e8f0; border-radius: 10px; outline: none;">
    <button onclick="sendAdminMessage()" style="background: var(--primary); color: white; border: none; width: 45px; height: 45px; border-radius: 10px;">
        <i class="fas fa-paper-plane"></i>
    </button>
</div>
        </div>
            
    </div>
	
	
	
	<div id="user-profile-modal" class="modal" style="display: none; position: fixed; z-index: 10002; left: 0; top: 0; width: 100%; height: 100dvh; background: white; overflow-y: auto;">
    
    <div style="position: sticky; top: 0; background: white; z-index: 10; padding: calc(15px + env(safe-area-inset-top)) 20px 15px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #eee;">
        <div style="display: flex; align-items: center; gap: 15px;">
            <button onclick="closeUserProfile()" style="border: none; background: #f1f5f9; width: 40px; height: 40px; border-radius: 50%; cursor: pointer;">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h3 style="margin: 0; font-size: 1.1em; color: var(--dark);" data-i18n-key="title_member_profile">
			‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
		</h3>
        </div>
        <i class="fas fa-ellipsis-v" style="color: #ccc;"></i>
    </div>

    <div id="user-profile-content" style="padding: 20px; max-width: 500px; margin: 0 auto; width: 100%;">
        </div>
</div>

	
	
	
	<div id="section-members-list" style="display: none;">
    <div style="margin-bottom: 20px; display: flex; flex-direction: column; gap: 10px;">
        <div style="display: flex; gap: 10px;">
            <input type="text" id="member-search-input" placeholder="Search Username..." 
                   style="flex: 1; padding: 12px; border: 1px solid #e2e8f0; border-radius: 12px; outline: none; font-family: 'Kanit';">
            <button onclick="loadMemberList()" style="background: var(--primary); color: white; border: none; padding: 0 20px; border-radius: 12px; cursor: pointer;">
                <i class="fas fa-search"></i>
            </button>
        </div>
        
        <select id="member-filter-status" onchange="loadMemberList()" style="width: 100%; padding: 10px; border-radius: 10px; border: 1px solid #e2e8f0; font-family: 'Kanit'; outline: none; background: white;">
				<option value="all" data-i18n-key="filter_all">‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
				<option value="kyc" data-i18n-key="filter_kyc">‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡πÅ‡∏•‡πâ‡∏ß (KYC)</option>
				<option value="not_kyc" data-i18n-key="filter_not_kyc">‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡∏ô</option>
				<option value="banned" data-i18n-key="filter_banned">‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡πÅ‡∏ö‡∏ô</option>
		</select>
    </div>

    <div id="members-list-container" style="display: flex; flex-direction: column; gap: 12px;">
    </div>
</div>


	



</body>
</html>